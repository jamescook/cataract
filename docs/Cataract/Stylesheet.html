<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Cataract::Stylesheet
  
    &mdash; Cataract - Fast CSS Parser
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Cataract::Stylesheet";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (S)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Cataract.html" title="Cataract (module)">Cataract</a></span></span>
     &raquo; 
    <span class="title">Stylesheet</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Cataract::Stylesheet
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Cataract::Stylesheet</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/cataract/stylesheet.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Represents a parsed CSS stylesheet with support for querying, mutation, and serialization.</p>

<p>A Stylesheet contains CSS rules organized by media queries. It provides methods for:</p>
<ul><li>
<p>Parsing CSS from strings, files, or URIs</p>
</li><li>
<p>Querying rules by selector, specificity, or property</p>
</li><li>
<p>Adding and removing rules</p>
</li><li>
<p>Serializing back to CSS strings</p>
</li></ul>

<p>Stylesheets are mutable - you can parse multiple CSS sources into the same stylesheet and they will be merged together.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Basic usage</p>
</div></h5>
      
      <pre class="example code"><code><span class='comment'># Parse from string
</span><span class='id identifier rubyid_sheet'>sheet</span> <span class='op'>=</span> <span class='const'>Stylesheet</span><span class='period'>.</span><span class='id identifier rubyid_parse'><span class='object_link'><a href="#parse-class_method" title="Cataract::Stylesheet.parse (method)">parse</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>body { color: red; }</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

<span class='comment'># Query rules
</span><span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_each_selector'>each_selector</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_sel'>sel</span><span class='comma'>,</span> <span class='id identifier rubyid_decls'>decls</span><span class='comma'>,</span> <span class='id identifier rubyid_spec'>spec</span><span class='comma'>,</span> <span class='id identifier rubyid_media'>media</span><span class='op'>|</span> <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_sel'>sel</span><span class='embexpr_end'>}</span><span class='tstring_content'>: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_decls'>decls</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>

<span class='comment'># Add more rules
</span><span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_add_block'>add_block</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>h1 { color: blue; }</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

<span class='comment'># Serialize back to CSS
</span><span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span></code></pre>
    
  </div>


  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="../Cataract.html#parse_css-class_method" title="Cataract.parse_css (method)">Convenience method for parsing</a></span></li>
    
      <li><span class='object_link'><a href="RuleSet.html" title="Cataract::RuleSet (class)">Individual CSS rule representation</a></span></li>
    
  </ul>

</div>



  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#charset-instance_method" title="#charset (instance method)">#<strong>charset</strong>  &#x21d2; String<sup>?</sup> </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The @charset declaration from the CSS, if present.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#rule_groups-instance_method" title="#rule_groups (instance method)">#<strong>rule_groups</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'>
<p>Expose rule groups for C merge implementation.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#load_file-class_method" title="load_file (class method)">.<strong>load_file</strong>(filename, base_dir = &#39;.&#39;, **options)  &#x21d2; Stylesheet </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Load CSS from a file and return a new Stylesheet.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#load_uri-class_method" title="load_uri (class method)">.<strong>load_uri</strong>(uri, **options)  &#x21d2; Stylesheet </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Load CSS from a URI and return a new Stylesheet.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#parse-class_method" title="parse (class method)">.<strong>parse</strong>(css, **options)  &#x21d2; Stylesheet </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Parse a CSS string and return a new Stylesheet.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_block-instance_method" title="#add_block (instance method)">#<strong>add_block</strong>(css_string, fix_braces: false, media_types: nil)  &#x21d2; self </a>
    

    
      (also: #load_string)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Parse and add a CSS block to this stylesheet.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_rule-instance_method" title="#add_rule (instance method)">#<strong>add_rule</strong>(selector:, declarations:, media_types: [:all])  &#x21d2; RuleSet </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Add a single CSS rule to the stylesheet.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_rule_set!-instance_method" title="#add_rule_set! (instance method)">#<strong>add_rule_set!</strong>(rule_set)  &#x21d2; self </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Add a RuleSet object to the stylesheet.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#clear!-instance_method" title="#clear! (instance method)">#<strong>clear!</strong>  &#x21d2; self </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Remove all rules from the stylesheet.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#declarations-instance_method" title="#declarations (instance method)">#<strong>declarations</strong>  &#x21d2; Array&lt;Declaration&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Get all declarations from the stylesheet after applying CSS cascade rules.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#each_rule_set-instance_method" title="#each_rule_set (instance method)">#<strong>each_rule_set</strong>(media_types = :all) {|rule_set, media_types| ... } &#x21d2; Enumerator </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Iterate through RuleSet objects with optional media type filtering.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#each_selector-instance_method" title="#each_selector (instance method)">#<strong>each_selector</strong>(media: :all, specificity: nil, property: nil, property_value: nil) {|selector, declarations, specificity, media_types| ... } &#x21d2; Enumerator </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Iterate over each selector in the stylesheet with optional filtering.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#empty%3F-instance_method" title="#empty? (instance method)">#<strong>empty?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Check if the stylesheet has no rules.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#find_by_selector-instance_method" title="#find_by_selector (instance method)">#<strong>find_by_selector</strong>(selector, media_types = :all)  &#x21d2; Array&lt;Declarations&gt; </a>
    

    
      (also: #[])
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Find all declaration blocks for a specific selector.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#find_rule_sets-instance_method" title="#find_rule_sets (instance method)">#<strong>find_rule_sets</strong>(selectors, media_types = :all)  &#x21d2; Array&lt;RuleSet&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Find RuleSets matching any of the given selectors.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(options = {})  &#x21d2; Stylesheet </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create a new empty stylesheet.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#inspect-instance_method" title="#inspect (instance method)">#<strong>inspect</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#load_file-instance_method" title="#load_file (instance method)">#<strong>load_file</strong>(filename, base_dir = &#39;.&#39;, _media_types = :all)  &#x21d2; self </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Load CSS from a local file and add to this stylesheet.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#load_uri-instance_method" title="#load_uri (instance method)">#<strong>load_uri</strong>(uri, options = {})  &#x21d2; self </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Load CSS from a URI and add to this stylesheet.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#parse-instance_method" title="#parse (instance method)">#<strong>parse</strong>(css_string)  &#x21d2; self </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Parse CSS and merge into this stylesheet.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#remove_rule_set!-instance_method" title="#remove_rule_set! (instance method)">#<strong>remove_rule_set!</strong>(rule_set)  &#x21d2; self </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Remove a specific RuleSet from the stylesheet.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#remove_rules!-instance_method" title="#remove_rules! (instance method)">#<strong>remove_rules!</strong>(selector: nil, media_types: nil)  &#x21d2; self </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Remove rules matching the given criteria.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#rules-instance_method" title="#rules (instance method)">#<strong>rules</strong>(&amp;block)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#selectors-instance_method" title="#selectors (instance method)">#<strong>selectors</strong>(media_types = :all)  &#x21d2; Array&lt;String&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Get array of all selectors, optionally filtered by media type.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#size-instance_method" title="#size (instance method)">#<strong>size</strong>  &#x21d2; Integer </a>
    

    
      (also: #length, #rules_count)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Get the total number of rules in the stylesheet.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_formatted_s-instance_method" title="#to_formatted_s (instance method)">#<strong>to_formatted_s</strong>(which_media = :all)  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Serialize stylesheet to formatted CSS string with indentation.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_h-instance_method" title="#to_h (instance method)">#<strong>to_h</strong>  &#x21d2; Hash </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Convert stylesheet to nested hash structure.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_s-instance_method" title="#to_s (instance method)">#<strong>to_s</strong>(which_media = :all)  &#x21d2; String </a>
    

    
      (also: #to_css)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Serialize stylesheet to compact CSS string.</p>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(options = {})  &#x21d2; <tt><span class='object_link'><a href="" title="Cataract::Stylesheet (class)">Stylesheet</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create a new empty stylesheet.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Create empty stylesheet</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Cataract::Stylesheet (class)">Stylesheet</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
<span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>body { color: red; }</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>With import resolution</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Cataract::Stylesheet (class)">Stylesheet</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='label'>import:</span> <span class='kw'>true</span><span class='rparen'>)</span>
<span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>@import &#39;style.css&#39;;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>With custom import options</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Cataract::Stylesheet (class)">Stylesheet</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='label'>import:</span> <span class='lbrace'>{</span>
  <span class='label'>allowed_schemes:</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>https</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>file</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='label'>base_path:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/path/to/css</span><span class='tstring_end'>&#39;</span></span>
<span class='rbrace'>}</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Configuration options</p>
</div>
      
    </li>
  
</ul>

  
    
    
    <p class="tag_title">Options Hash (<tt>options</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:import</span>
          <span class="type">(<tt>Boolean</tt>, <tt>Hash</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Enable @import resolution. Pass true for defaults, or a hash with:</p>
<ul><li>
<p>:allowed_schemes [Array&lt;String&gt;] URI schemes to allow (default: [‘https’])</p>
</li><li>
<p>:extensions [Array&lt;String&gt;] File extensions to allow (default: [‘css’])</p>
</li><li>
<p>:max_depth [Integer] Maximum import nesting (default: 5)</p>
</li><li>
<p>:base_path [String] Base directory for relative imports</p>
</li></ul>
</div>
          
        </li>
      
        <li>
          <span class="name">:io_exceptions</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>true</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Whether to raise exceptions on I/O errors (file not found, network errors, etc.)</p>
</div>
          
        </li>
      
    </ul>
  


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


59
60
61
62
63
64
65
66
67
68
69</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cataract/stylesheet.rb', line 59</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='ivar'>@options</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='label'>import:</span> <span class='kw'>false</span><span class='comma'>,</span>
    <span class='label'>io_exceptions:</span> <span class='kw'>true</span>
  <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>

  <span class='comment'># YJIT-friendly: define all instance variables upfront
</span>  <span class='comment'># @rule_groups is a hash: {media_query_string =&gt; {media_types: [...], rules: [...]}}
</span>  <span class='ivar'>@rule_groups</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='ivar'>@charset</span> <span class='op'>=</span> <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="charset-instance_method">
  
    #<strong>charset</strong>  &#x21d2; <tt>String</tt><sup>?</sup>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns The @charset declaration from the CSS, if present.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>, <tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The @charset declaration from the CSS, if present</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


32
33
34</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cataract/stylesheet.rb', line 32</span>

<span class='kw'>def</span> <span class='id identifier rubyid_charset'>charset</span>
  <span class='ivar'>@charset</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="rule_groups-instance_method">
  
    #<strong>rule_groups</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>

<p>Expose rule groups for C merge implementation</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1119
1120
1121</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cataract/stylesheet.rb', line 1119</span>

<span class='kw'>def</span> <span class='id identifier rubyid_rule_groups'>rule_groups</span>
  <span class='ivar'>@rule_groups</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="load_file-class_method">
  
    .<strong>load_file</strong>(filename, base_dir = &#39;.&#39;, **options)  &#x21d2; <tt><span class='object_link'><a href="" title="Cataract::Stylesheet (class)">Stylesheet</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Load CSS from a file and return a new Stylesheet.</p>

<p>Reads the file and parses its contents. If import resolution is enabled, the file’s directory is used as the base path for resolving relative imports.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Load a CSS file</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Cataract::Stylesheet (class)">Stylesheet</a></span></span><span class='period'>.</span><span class='id identifier rubyid_load_file'>load_file</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>style.css</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Load with relative base directory</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Cataract::Stylesheet (class)">Stylesheet</a></span></span><span class='period'>.</span><span class='id identifier rubyid_load_file'>load_file</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>components/button.css</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>assets/css</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>filename</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Path to the CSS file</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>base_dir</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;.&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Base directory for resolving the filename (default: ‘.’)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Options passed to Stylesheet.new</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    
    
    <p class="tag_title">Options Hash (<tt>**options</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:import</span>
          <span class="type">(<tt>Boolean</tt>, <tt>Hash</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Enable @import resolution</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:io_exceptions</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>true</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Raise exceptions on I/O errors</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Cataract::Stylesheet (class)">Stylesheet</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A new Stylesheet containing the parsed CSS</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>IOError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>If the file doesn’t exist and io_exceptions is enabled</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#load_file-instance_method" title="Cataract::Stylesheet#load_file (method)">Instance method for loading into existing stylesheet</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


117
118
119
120
121</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cataract/stylesheet.rb', line 117</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_load_file'>load_file</span><span class='lparen'>(</span><span class='id identifier rubyid_filename'>filename</span><span class='comma'>,</span> <span class='id identifier rubyid_base_dir'>base_dir</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_sheet'>sheet</span> <span class='op'>=</span> <span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_load_file'>load_file</span><span class='lparen'>(</span><span class='id identifier rubyid_filename'>filename</span><span class='comma'>,</span> <span class='id identifier rubyid_base_dir'>base_dir</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_sheet'>sheet</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="load_uri-class_method">
  
    .<strong>load_uri</strong>(uri, **options)  &#x21d2; <tt><span class='object_link'><a href="" title="Cataract::Stylesheet (class)">Stylesheet</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Load CSS from a URI and return a new Stylesheet.</p>

<p>Supports http://, https://, and file:// URIs. Network requests use open-uri with a 10 second timeout and follow redirects.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Load from HTTPS</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Cataract::Stylesheet (class)">Stylesheet</a></span></span><span class='period'>.</span><span class='id identifier rubyid_load_uri'>load_uri</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>https://example.com/style.css</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Load local file</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Cataract::Stylesheet (class)">Stylesheet</a></span></span><span class='period'>.</span><span class='id identifier rubyid_load_uri'>load_uri</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>file:///path/to/style.css</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>uri</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>URI to load CSS from (http://, https://, or file://)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Options passed to Stylesheet.new</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>**options</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:import</span>
          <span class="type">(<tt>Boolean</tt>, <tt>Hash</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Enable @import resolution</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:io_exceptions</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>true</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Raise exceptions on I/O errors</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Cataract::Stylesheet (class)">Stylesheet</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A new Stylesheet containing the parsed CSS</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>IOError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>If the URI can’t be loaded and io_exceptions is enabled</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt>ArgumentError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>If the URI scheme is not supported</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#load_uri-instance_method" title="Cataract::Stylesheet#load_uri (method)">Instance method for loading into existing stylesheet</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


143
144
145
146
147</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cataract/stylesheet.rb', line 143</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_load_uri'>load_uri</span><span class='lparen'>(</span><span class='id identifier rubyid_uri'>uri</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_sheet'>sheet</span> <span class='op'>=</span> <span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_load_uri'>load_uri</span><span class='lparen'>(</span><span class='id identifier rubyid_uri'>uri</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_sheet'>sheet</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="parse-class_method">
  
    .<strong>parse</strong>(css, **options)  &#x21d2; <tt><span class='object_link'><a href="" title="Cataract::Stylesheet (class)">Stylesheet</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Parse a CSS string and return a new Stylesheet.</p>

<p>This is a convenience class method that creates a new Stylesheet and parses the CSS in one step.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Parse simple CSS</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Cataract::Stylesheet (class)">Stylesheet</a></span></span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>body { color: red; }</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='comment'>#=&gt; 1</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Parse with imports</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Cataract::Stylesheet (class)">Stylesheet</a></span></span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>@import &#39;style.css&#39;;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>import:</span> <span class='kw'>true</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>css</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The CSS string to parse</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Options passed to Stylesheet.new</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>**options</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:import</span>
          <span class="type">(<tt>Boolean</tt>, <tt>Hash</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Enable @import resolution</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:io_exceptions</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>true</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Raise exceptions on I/O errors</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Cataract::Stylesheet (class)">Stylesheet</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A new Stylesheet containing the parsed CSS</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>IOError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>If import resolution fails and io_exceptions is enabled</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#parse-instance_method" title="Cataract::Stylesheet#parse (method)">Instance method for parsing into existing stylesheet</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


91
92
93
94
95</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cataract/stylesheet.rb', line 91</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_css'>css</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_sheet'>sheet</span> <span class='op'>=</span> <span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_css'>css</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_sheet'>sheet</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="add_block-instance_method">
  
    #<strong>add_block</strong>(css_string, fix_braces: false, media_types: nil)  &#x21d2; <tt>self</tt> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='load_string-instance_method'>load_string</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Parse and add a CSS block to this stylesheet.</p>

<p>This method parses a CSS string and adds all rules to the stylesheet. Optionally auto-fixes malformed CSS and overrides media types.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Add CSS block</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Cataract::Stylesheet (class)">Stylesheet</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="#initialize-instance_method" title="Cataract::Stylesheet#initialize (method)">new</a></span></span>
<span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_add_block'>add_block</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>body { color: red; }</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_add_block'>add_block</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>h1 { color: blue; }</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Fix malformed CSS</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_add_block'>add_block</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>body { color: red;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>fix_braces:</span> <span class='kw'>true</span><span class='rparen'>)</span>
<span class='comment'># Automatically closes the missing brace</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Override media types</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_add_block'>add_block</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>body { color: red; }</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>media_types:</span> <span class='symbol'>:print</span><span class='rparen'>)</span>
<span class='comment'># Rule is added as print media, even if CSS had no @media query</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Force all rules to specific media</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_css'>css</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>@media screen { body { color: red; } }</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_add_block'>add_block</span><span class='lparen'>(</span><span class='id identifier rubyid_css'>css</span><span class='comma'>,</span> <span class='label'>media_types:</span> <span class='symbol'>:print</span><span class='rparen'>)</span>
<span class='comment'># Ignores @media screen, adds as print media instead</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>css_string</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The CSS string to parse and add</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>fix_braces</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>false</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Auto-close missing closing braces (default: false) If true, automatically adds closing braces for unbalanced CSS blocks</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>media_types</span>
      
      
        <span class='type'>(<tt>Symbol</tt>, <tt>Array&lt;Symbol&gt;</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Override media types for all added rules (default: nil) When nil, uses media types from CSS (e.g., @media queries) When specified, forces all rules to use these media types instead</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>self</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Returns self for method chaining</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#parse-instance_method" title="Cataract::Stylesheet#parse (method)">For parsing without auto-fixing</a></span></li>
    
      <li><span class='object_link'><a href="#load_string-instance_method" title="Cataract::Stylesheet#load_string (method)">Alias for this method</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cataract/stylesheet.rb', line 405</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_block'>add_block</span><span class='lparen'>(</span><span class='id identifier rubyid_css_string'>css_string</span><span class='comma'>,</span> <span class='label'>fix_braces:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='label'>media_types:</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_css_to_parse'>css_to_parse</span> <span class='op'>=</span> <span class='id identifier rubyid_css_string'>css_string</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_fix_braces'>fix_braces</span>
    <span class='comment'># Count braces - if unbalanced, add missing closing braces
</span>    <span class='id identifier rubyid_open_braces'>open_braces</span> <span class='op'>=</span> <span class='id identifier rubyid_css_string'>css_string</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>{</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_close_braces'>close_braces</span> <span class='op'>=</span> <span class='id identifier rubyid_css_string'>css_string</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>}</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_css_to_parse'>css_to_parse</span> <span class='op'>=</span> <span class='id identifier rubyid_css_string'>css_string</span> <span class='op'>+</span> <span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> }</span><span class='tstring_end'>&#39;</span></span> <span class='op'>*</span> <span class='lparen'>(</span><span class='id identifier rubyid_open_braces'>open_braces</span> <span class='op'>-</span> <span class='id identifier rubyid_close_braces'>close_braces</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_open_braces'>open_braces</span> <span class='op'>&gt;</span> <span class='id identifier rubyid_close_braces'>close_braces</span>
  <span class='kw'>end</span>

  <span class='comment'># Track rules count before parsing to identify newly added rules
</span>  <span class='id identifier rubyid_rules_before'>rules_before</span> <span class='op'>=</span> <span class='ivar'>@rule_groups</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>

  <span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_css_to_parse'>css_to_parse</span><span class='rparen'>)</span>

  <span class='comment'># Override media types if specified
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_media_types'>media_types</span>
    <span class='comment'># Normalize media_types to array
</span>    <span class='id identifier rubyid_override_media_types'>override_media_types</span> <span class='op'>=</span> <span class='const'>Array</span><span class='lparen'>(</span><span class='id identifier rubyid_media_types'>media_types</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:to_sym</span><span class='rparen'>)</span>

    <span class='comment'># Determine new media key for the overridden rules
</span>    <span class='id identifier rubyid_new_media_key'>new_media_key</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_override_media_types'>override_media_types</span> <span class='op'>==</span> <span class='lbracket'>[</span><span class='symbol'>:all</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id identifier rubyid_override_media_types'>override_media_types</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
                      <span class='kw'>nil</span>
                    <span class='kw'>else</span>
                      <span class='id identifier rubyid_override_media_types'>override_media_types</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:to_s</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>, </span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
                    <span class='kw'>end</span>

    <span class='comment'># Collect all rules that were added during this parse call
</span>    <span class='id identifier rubyid_new_rules'>new_rules</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='ivar'>@rule_groups</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_query_string'>query_string</span><span class='comma'>,</span> <span class='id identifier rubyid_group'>group</span><span class='op'>|</span>
      <span class='comment'># Skip groups that existed before
</span>      <span class='kw'>if</span> <span class='id identifier rubyid_rules_before'>rules_before</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='id identifier rubyid_query_string'>query_string</span><span class='rparen'>)</span>
        <span class='comment'># Only take rules that weren&#39;t in the group before
</span>        <span class='id identifier rubyid_old_count'>old_count</span> <span class='op'>=</span> <span class='id identifier rubyid_rules_before'>rules_before</span><span class='lbracket'>[</span><span class='id identifier rubyid_query_string'>query_string</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:rules</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span>
        <span class='id identifier rubyid_new_count'>new_count</span> <span class='op'>=</span> <span class='id identifier rubyid_group'>group</span><span class='lbracket'>[</span><span class='symbol'>:rules</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_new_count'>new_count</span> <span class='op'>&gt;</span> <span class='id identifier rubyid_old_count'>old_count</span>
          <span class='id identifier rubyid_new_rules'>new_rules</span><span class='period'>.</span><span class='id identifier rubyid_concat'>concat</span><span class='lparen'>(</span><span class='id identifier rubyid_group'>group</span><span class='lbracket'>[</span><span class='symbol'>:rules</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_old_count'>old_count</span><span class='op'>..</span><span class='rbracket'>]</span><span class='rparen'>)</span>
          <span class='comment'># Remove the newly added rules from their original group
</span>          <span class='id identifier rubyid_group'>group</span><span class='lbracket'>[</span><span class='symbol'>:rules</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_group'>group</span><span class='lbracket'>[</span><span class='symbol'>:rules</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='int'>0</span><span class='op'>...</span><span class='id identifier rubyid_old_count'>old_count</span><span class='rbracket'>]</span>
        <span class='kw'>end</span>
      <span class='kw'>else</span>
        <span class='comment'># Entire group is new - take all its rules
</span>        <span class='id identifier rubyid_new_rules'>new_rules</span><span class='period'>.</span><span class='id identifier rubyid_concat'>concat</span><span class='lparen'>(</span><span class='id identifier rubyid_group'>group</span><span class='lbracket'>[</span><span class='symbol'>:rules</span><span class='rbracket'>]</span><span class='rparen'>)</span>
        <span class='comment'># Clear the group
</span>        <span class='id identifier rubyid_group'>group</span><span class='lbracket'>[</span><span class='symbol'>:rules</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_clear'>clear</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='comment'># Remove empty groups
</span>    <span class='ivar'>@rule_groups</span><span class='period'>.</span><span class='id identifier rubyid_delete_if'>delete_if</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid__key'>_key</span><span class='comma'>,</span> <span class='id identifier rubyid_group'>group</span><span class='op'>|</span> <span class='id identifier rubyid_group'>group</span><span class='lbracket'>[</span><span class='symbol'>:rules</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='rbrace'>}</span>

    <span class='comment'># Add all new rules to the override media type group
</span>    <span class='kw'>unless</span> <span class='id identifier rubyid_new_rules'>new_rules</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
      <span class='ivar'>@rule_groups</span><span class='lbracket'>[</span><span class='id identifier rubyid_new_media_key'>new_media_key</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='lbrace'>{</span> <span class='label'>media_types:</span> <span class='id identifier rubyid_override_media_types'>override_media_types</span><span class='comma'>,</span> <span class='label'>rules:</span> <span class='lbracket'>[</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
      <span class='ivar'>@rule_groups</span><span class='lbracket'>[</span><span class='id identifier rubyid_new_media_key'>new_media_key</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:rules</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_concat'>concat</span><span class='lparen'>(</span><span class='id identifier rubyid_new_rules'>new_rules</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="add_rule-instance_method">
  
    #<strong>add_rule</strong>(selector:, declarations:, media_types: [:all])  &#x21d2; <tt><span class='object_link'><a href="RuleSet.html" title="Cataract::RuleSet (class)">RuleSet</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Add a single CSS rule to the stylesheet.</p>

<p>This method creates and adds a rule with the specified selector and declarations. Unlike add_block, this operates on structured data rather than parsing CSS strings.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Add rule with string declarations</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_add_rule'>add_rule</span><span class='lparen'>(</span><span class='label'>selector:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>body</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>declarations:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>color: red; margin: 10px</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Add rule with hash declarations</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_add_rule'>add_rule</span><span class='lparen'>(</span><span class='label'>selector:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>.button</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>declarations:</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>color</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>blue</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>padding</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>10px</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span><span class='rparen'>)</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Add rule with specific media types</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_add_rule'>add_rule</span><span class='lparen'>(</span><span class='label'>selector:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>body</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>declarations:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>font-size: 12pt</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>media_types:</span> <span class='symbol'>:print</span><span class='rparen'>)</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Add rule with multiple media types</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_add_rule'>add_rule</span><span class='lparen'>(</span><span class='label'>selector:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>.mobile</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>declarations:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>width: 100%</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>media_types:</span> <span class='lbracket'>[</span><span class='symbol'>:screen</span><span class='comma'>,</span> <span class='symbol'>:handheld</span><span class='rbracket'>]</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>selector</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The CSS selector (e.g., “body”, “.class”, “#id”)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>declarations</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt><span class='object_link'><a href="Declarations.html" title="Cataract::Declarations (class)">Declarations</a></span></tt>, <tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The CSS declarations Can be a declaration string (“color: red; margin: 10px”), a Declarations object, or a Hash ({ “color” =&gt; “red” })</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>media_types</span>
      
      
        <span class='type'>(<tt>Symbol</tt>, <tt>Array&lt;Symbol&gt;</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>[:all]</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Media types for this rule (default: [:all]) Use :all for no media query, or specify :screen, :print, etc.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="RuleSet.html" title="Cataract::RuleSet (class)">RuleSet</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The created RuleSet object</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#add_block-instance_method" title="Cataract::Stylesheet#add_block (method)">For parsing CSS strings</a></span></li>
    
      <li><span class='object_link'><a href="#add_rule_set!-instance_method" title="Cataract::Stylesheet#add_rule_set! (method)">For adding RuleSet objects</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cataract/stylesheet.rb', line 522</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_rule'>add_rule</span><span class='lparen'>(</span><span class='label'>selector:</span><span class='comma'>,</span> <span class='label'>declarations:</span><span class='comma'>,</span> <span class='label'>media_types:</span> <span class='lbracket'>[</span><span class='symbol'>:all</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='comment'># Convert declarations to Declarations object if needed
</span>  <span class='id identifier rubyid_decls'>decls</span> <span class='op'>=</span> <span class='id identifier rubyid_declarations'>declarations</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Declarations.html" title="Cataract::Declarations (class)">Declarations</a></span></span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id identifier rubyid_declarations'>declarations</span> <span class='op'>:</span> <span class='const'><span class='object_link'><a href="Declarations.html" title="Cataract::Declarations (class)">Declarations</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Declarations.html#initialize-instance_method" title="Cataract::Declarations#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_declarations'>declarations</span><span class='rparen'>)</span>

  <span class='comment'># Create Rule struct (no media_query field - stored at group level)
</span>  <span class='id identifier rubyid_rule'>rule</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Cataract.html" title="Cataract (module)">Cataract</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Rule.html" title="Cataract::Rule (class)">Rule</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
    <span class='id identifier rubyid_selector'>selector</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='comma'>,</span>
    <span class='id identifier rubyid_decls'>decls</span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span><span class='comma'>,</span>
    <span class='kw'>nil</span> <span class='comment'># specificity calculated on demand
</span>  <span class='rparen'>)</span>

  <span class='comment'># Normalize media_types to array
</span>  <span class='id identifier rubyid_media_types_array'>media_types_array</span> <span class='op'>=</span> <span class='const'>Array</span><span class='lparen'>(</span><span class='id identifier rubyid_media_types'>media_types</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:to_sym</span><span class='rparen'>)</span>

  <span class='comment'># Determine media query string key
</span>  <span class='comment'># For now, map media_types to simple strings
</span>  <span class='comment'># TODO: This is a simplified approach - may need enhancement
</span>  <span class='id identifier rubyid_media_key'>media_key</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_media_types_array'>media_types_array</span> <span class='op'>==</span> <span class='lbracket'>[</span><span class='symbol'>:all</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id identifier rubyid_media_types_array'>media_types_array</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
                <span class='kw'>nil</span> <span class='comment'># No media query
</span>              <span class='kw'>else</span>
                <span class='id identifier rubyid_media_types_array'>media_types_array</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:to_s</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>, </span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
              <span class='kw'>end</span>

  <span class='comment'># Get or create group
</span>  <span class='ivar'>@rule_groups</span><span class='lbracket'>[</span><span class='id identifier rubyid_media_key'>media_key</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='lbrace'>{</span> <span class='label'>media_types:</span> <span class='id identifier rubyid_media_types_array'>media_types_array</span><span class='comma'>,</span> <span class='label'>rules:</span> <span class='lbracket'>[</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
  <span class='ivar'>@rule_groups</span><span class='lbracket'>[</span><span class='id identifier rubyid_media_key'>media_key</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:rules</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_rule'>rule</span>

  <span class='comment'># Return RuleSet wrapper for user-facing API (css_parser compatibility)
</span>  <span class='const'><span class='object_link'><a href="RuleSet.html" title="Cataract::RuleSet (class)">RuleSet</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="RuleSet.html#initialize-instance_method" title="Cataract::RuleSet#initialize (method)">new</a></span></span><span class='lparen'>(</span>
    <span class='label'>selector:</span> <span class='id identifier rubyid_rule'>rule</span><span class='period'>.</span><span class='id identifier rubyid_selector'>selector</span><span class='comma'>,</span>
    <span class='label'>declarations:</span> <span class='const'><span class='object_link'><a href="Declarations.html" title="Cataract::Declarations (class)">Declarations</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Declarations.html#initialize-instance_method" title="Cataract::Declarations#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_rule'>rule</span><span class='period'>.</span><span class='id identifier rubyid_declarations'>declarations</span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='label'>media_types:</span> <span class='id identifier rubyid_media_types_array'>media_types_array</span>
  <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="add_rule_set!-instance_method">
  
    #<strong>add_rule_set!</strong>(rule_set)  &#x21d2; <tt>self</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Add a RuleSet object to the stylesheet.</p>

<p>This method takes an existing RuleSet object (typically from another stylesheet or created manually) and adds it to this stylesheet. The RuleSet’s selector, declarations, and media types are preserved.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Add RuleSet from another stylesheet</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet1'>sheet1</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Cataract::Stylesheet (class)">Stylesheet</a></span></span><span class='period'>.</span><span class='id identifier rubyid_parse'><span class='object_link'><a href="#parse-class_method" title="Cataract::Stylesheet.parse (method)">parse</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>body { color: red; }</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_sheet2'>sheet2</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Cataract::Stylesheet (class)">Stylesheet</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="#initialize-instance_method" title="Cataract::Stylesheet#initialize (method)">new</a></span></span>
<span class='id identifier rubyid_sheet1'>sheet1</span><span class='period'>.</span><span class='id identifier rubyid_each_rule_set'>each_rule_set</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_rs'>rs</span><span class='comma'>,</span> <span class='id identifier rubyid__media'>_media</span><span class='op'>|</span> <span class='id identifier rubyid_sheet2'>sheet2</span><span class='period'>.</span><span class='id identifier rubyid_add_rule_set!'>add_rule_set!</span><span class='lparen'>(</span><span class='id identifier rubyid_rs'>rs</span><span class='rparen'>)</span> <span class='rbrace'>}</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Copy rules between stylesheets</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_source'>source</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Cataract::Stylesheet (class)">Stylesheet</a></span></span><span class='period'>.</span><span class='id identifier rubyid_parse'><span class='object_link'><a href="#parse-class_method" title="Cataract::Stylesheet.parse (method)">parse</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>h1 { color: blue; } p { margin: 10px; }</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_target'>target</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Cataract::Stylesheet (class)">Stylesheet</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="#initialize-instance_method" title="Cataract::Stylesheet#initialize (method)">new</a></span></span>
<span class='id identifier rubyid_source'>source</span><span class='period'>.</span><span class='id identifier rubyid_each_rule_set'>each_rule_set</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_rs'>rs</span><span class='op'>|</span> <span class='id identifier rubyid_target'>target</span><span class='period'>.</span><span class='id identifier rubyid_add_rule_set!'>add_rule_set!</span><span class='lparen'>(</span><span class='id identifier rubyid_rs'>rs</span><span class='rparen'>)</span> <span class='rbrace'>}</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>rule_set</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="RuleSet.html" title="Cataract::RuleSet (class)">RuleSet</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The RuleSet object to add</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>self</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Returns self for method chaining</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#add_rule-instance_method" title="Cataract::Stylesheet#add_rule (method)">For adding rules from raw data</a></span></li>
    
      <li><span class='object_link'><a href="#each_rule_set-instance_method" title="Cataract::Stylesheet#each_rule_set (method)">For iterating RuleSets</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


587
588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604
605
606</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cataract/stylesheet.rb', line 587</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_rule_set!'>add_rule_set!</span><span class='lparen'>(</span><span class='id identifier rubyid_rule_set'>rule_set</span><span class='rparen'>)</span>
  <span class='comment'># Convert RuleSet to Rule struct
</span>  <span class='id identifier rubyid_rule'>rule</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Cataract.html" title="Cataract (module)">Cataract</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Rule.html" title="Cataract::Rule (class)">Rule</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
    <span class='id identifier rubyid_rule_set'>rule_set</span><span class='period'>.</span><span class='id identifier rubyid_selector'>selector</span><span class='comma'>,</span>
    <span class='id identifier rubyid_rule_set'>rule_set</span><span class='period'>.</span><span class='id identifier rubyid_declarations'>declarations</span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span><span class='comma'>,</span>
    <span class='id identifier rubyid_rule_set'>rule_set</span><span class='period'>.</span><span class='id identifier rubyid_specificity'>specificity</span>
  <span class='rparen'>)</span>

  <span class='comment'># Determine media query key
</span>  <span class='id identifier rubyid_media_key'>media_key</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_rule_set'>rule_set</span><span class='period'>.</span><span class='id identifier rubyid_media_types'>media_types</span> <span class='op'>==</span> <span class='lbracket'>[</span><span class='symbol'>:all</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id identifier rubyid_rule_set'>rule_set</span><span class='period'>.</span><span class='id identifier rubyid_media_types'>media_types</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
                <span class='kw'>nil</span>
              <span class='kw'>else</span>
                <span class='id identifier rubyid_rule_set'>rule_set</span><span class='period'>.</span><span class='id identifier rubyid_media_types'>media_types</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:to_s</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>, </span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
              <span class='kw'>end</span>

  <span class='comment'># Get or create group
</span>  <span class='ivar'>@rule_groups</span><span class='lbracket'>[</span><span class='id identifier rubyid_media_key'>media_key</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='lbrace'>{</span> <span class='label'>media_types:</span> <span class='const'>Array</span><span class='lparen'>(</span><span class='id identifier rubyid_rule_set'>rule_set</span><span class='period'>.</span><span class='id identifier rubyid_media_types'>media_types</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:to_sym</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='label'>rules:</span> <span class='lbracket'>[</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
  <span class='ivar'>@rule_groups</span><span class='lbracket'>[</span><span class='id identifier rubyid_media_key'>media_key</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:rules</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_rule'>rule</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="clear!-instance_method">
  
    #<strong>clear!</strong>  &#x21d2; <tt>self</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Remove all rules from the stylesheet.</p>

<p>Clears all rules and resets the @charset. The stylesheet can be reused by parsing new CSS after calling this method.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Clear stylesheet</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Cataract::Stylesheet (class)">Stylesheet</a></span></span><span class='period'>.</span><span class='id identifier rubyid_parse'><span class='object_link'><a href="#parse-class_method" title="Cataract::Stylesheet.parse (method)">parse</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>body { color: red; }</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='comment'>#=&gt; 1
</span><span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_clear!'>clear!</span>
<span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='comment'>#=&gt; 0</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Reuse after clearing</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_clear!'>clear!</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>h1 { color: blue; }</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>self</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Returns self for method chaining</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#empty%3F-instance_method" title="Cataract::Stylesheet#empty? (method)">For checking if empty</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


900
901
902
903
904</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cataract/stylesheet.rb', line 900</span>

<span class='kw'>def</span> <span class='id identifier rubyid_clear!'>clear!</span>
  <span class='ivar'>@rule_groups</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='ivar'>@charset</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="declarations-instance_method">
  
    #<strong>declarations</strong>  &#x21d2; <tt>Array&lt;Declaration&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Get all declarations from the stylesheet after applying CSS cascade rules.</p>

<p>This method flattens all rules from all media queries and applies CSS cascade rules (specificity, importance, order) to compute the final declarations. The result is cached until the stylesheet is modified.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Get all declarations</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Cataract::Stylesheet (class)">Stylesheet</a></span></span><span class='period'>.</span><span class='id identifier rubyid_parse'><span class='object_link'><a href="#parse-class_method" title="Cataract::Stylesheet.parse (method)">parse</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>body { color: red; } body { margin: 10px; }</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_decls'>decls</span> <span class='op'>=</span> <span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_declarations'>declarations</span>
<span class='comment'># Returns declarations merged by cascade rules</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Declarations respect specificity</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Cataract::Stylesheet (class)">Stylesheet</a></span></span><span class='period'>.</span><span class='id identifier rubyid_parse'><span class='object_link'><a href="#parse-class_method" title="Cataract::Stylesheet.parse (method)">parse</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>.test { color: red; } #test { color: blue; }</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_decls'>decls</span> <span class='op'>=</span> <span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_declarations'>declarations</span>
<span class='comment'># Blue color wins due to higher specificity</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;Declaration&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Array of declaration values after cascade Returns empty array if stylesheet is empty.</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="../Cataract.html#merge-class_method" title="Cataract.merge (method)">For direct access to merge functionality</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


488
489
490
491
492
493</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cataract/stylesheet.rb', line 488</span>

<span class='kw'>def</span> <span class='id identifier rubyid_declarations'>declarations</span>
  <span class='comment'># Flatten all rules for cascade
</span>  <span class='id identifier rubyid_all_rules'>all_rules</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='ivar'>@rule_groups</span><span class='period'>.</span><span class='id identifier rubyid_each_value'>each_value</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_group'>group</span><span class='op'>|</span> <span class='id identifier rubyid_all_rules'>all_rules</span><span class='period'>.</span><span class='id identifier rubyid_concat'>concat</span><span class='lparen'>(</span><span class='id identifier rubyid_group'>group</span><span class='lbracket'>[</span><span class='symbol'>:rules</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='ivar'>@declarations</span> <span class='op'>||=</span> <span class='const'><span class='object_link'><a href="../Cataract.html" title="Cataract (module)">Cataract</a></span></span><span class='period'>.</span><span class='id identifier rubyid_apply_cascade'><span class='object_link'><a href="../Cataract.html#apply_cascade-class_method" title="Cataract.apply_cascade (method)">apply_cascade</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_all_rules'>all_rules</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="each_rule_set-instance_method">
  
    #<strong>each_rule_set</strong>(media_types = :all) {|rule_set, media_types| ... } &#x21d2; <tt>Enumerator</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Iterate through RuleSet objects with optional media type filtering.</p>

<p>This method yields RuleSet objects, which wrap the raw Rule structs with a user-friendly API. Each RuleSet provides access to the selector, declarations, specificity, and media types.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Iterate all rule sets</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_each_rule_set'>each_rule_set</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_rs'>rs</span><span class='comma'>,</span> <span class='id identifier rubyid_media'>media</span><span class='op'>|</span> <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_rs'>rs</span><span class='period'>.</span><span class='id identifier rubyid_selector'>selector</span><span class='embexpr_end'>}</span><span class='tstring_content'> (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_media'>media</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>, </span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Filter by media type</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_each_rule_set'>each_rule_set</span><span class='lparen'>(</span><span class='symbol'>:print</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_rs'>rs</span><span class='comma'>,</span> <span class='id identifier rubyid_media'>media</span><span class='op'>|</span> <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_rs'>rs</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='rbrace'>}</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Copy rules to another stylesheet</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_source'>source</span><span class='period'>.</span><span class='id identifier rubyid_each_rule_set'>each_rule_set</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_rs'>rs</span><span class='op'>|</span> <span class='id identifier rubyid_target'>target</span><span class='period'>.</span><span class='id identifier rubyid_add_rule_set!'>add_rule_set!</span><span class='lparen'>(</span><span class='id identifier rubyid_rs'>rs</span><span class='rparen'>)</span> <span class='rbrace'>}</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Use as Enumerator</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_rule_sets'>rule_sets</span> <span class='op'>=</span> <span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_each_rule_set'>each_rule_set</span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>media_types</span>
      
      
        <span class='type'>(<tt>Symbol</tt>, <tt>Array&lt;Symbol&gt;</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>:all</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Media type(s) to filter by (default: :all) Use :all for all media types, or specify :screen, :print, etc.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'>(<tt>rule_set</tt>, <tt>media_types</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Yields each RuleSet with its media types</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>rule_set</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="RuleSet.html" title="Cataract::RuleSet (class)">RuleSet</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The RuleSet object</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>media_types</span>
      
      
        <span class='type'>(<tt>Array&lt;Symbol&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Media types for this rule</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Enumerator</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>If no block given, returns an Enumerator</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#each_selector-instance_method" title="Cataract::Stylesheet#each_selector (method)">For simpler iteration (yields strings instead of objects)</a></span></li>
    
      <li><span class='object_link'><a href="RuleSet.html" title="Cataract::RuleSet (class)">For the RuleSet API</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


972
973
974
975
976
977
978
979
980
981
982
983
984
985
986
987
988
989
990
991
992
993
994
995
996
997</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cataract/stylesheet.rb', line 972</span>

<span class='kw'>def</span> <span class='id identifier rubyid_each_rule_set'>each_rule_set</span><span class='lparen'>(</span><span class='id identifier rubyid_media_types'>media_types</span> <span class='op'>=</span> <span class='symbol'>:all</span><span class='rparen'>)</span> <span class='comment'># :yields: rule_set, media_types
</span>  <span class='kw'>return</span> <span class='id identifier rubyid_enum_for'>enum_for</span><span class='lparen'>(</span><span class='symbol'>:each_rule_set</span><span class='comma'>,</span> <span class='id identifier rubyid_media_types'>media_types</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_block_given?'>block_given?</span>

  <span class='id identifier rubyid_query_media_types'>query_media_types</span> <span class='op'>=</span> <span class='const'>Array</span><span class='lparen'>(</span><span class='id identifier rubyid_media_types'>media_types</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:to_sym</span><span class='rparen'>)</span>

  <span class='ivar'>@rule_groups</span><span class='period'>.</span><span class='id identifier rubyid_each_value'>each_value</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_group'>group</span><span class='op'>|</span>
    <span class='comment'># Filter by media types at group level
</span>    <span class='id identifier rubyid_group_media_types'>group_media_types</span> <span class='op'>=</span> <span class='id identifier rubyid_group'>group</span><span class='lbracket'>[</span><span class='symbol'>:media_types</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

    <span class='comment'># :all matches everything
</span>    <span class='kw'>next</span> <span class='kw'>unless</span> <span class='id identifier rubyid_query_media_types'>query_media_types</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='symbol'>:all</span><span class='rparen'>)</span> <span class='op'>||</span>
                <span class='lparen'>(</span><span class='id identifier rubyid_group_media_types'>group_media_types</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_query_media_types'>query_media_types</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='symbol'>:all</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='op'>||</span>
                <span class='id identifier rubyid_group_media_types'>group_media_types</span><span class='period'>.</span><span class='id identifier rubyid_intersect?'>intersect?</span><span class='lparen'>(</span><span class='id identifier rubyid_query_media_types'>query_media_types</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_group'>group</span><span class='lbracket'>[</span><span class='symbol'>:rules</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_rule'>rule</span><span class='op'>|</span>
      <span class='comment'># Wrap Rule struct in RuleSet for user-facing API
</span>      <span class='id identifier rubyid_rule_set'>rule_set</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="RuleSet.html" title="Cataract::RuleSet (class)">RuleSet</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="RuleSet.html#initialize-instance_method" title="Cataract::RuleSet#initialize (method)">new</a></span></span><span class='lparen'>(</span>
        <span class='label'>selector:</span> <span class='id identifier rubyid_rule'>rule</span><span class='period'>.</span><span class='id identifier rubyid_selector'>selector</span><span class='comma'>,</span>
        <span class='label'>declarations:</span> <span class='const'><span class='object_link'><a href="Declarations.html" title="Cataract::Declarations (class)">Declarations</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Declarations.html#initialize-instance_method" title="Cataract::Declarations#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_rule'>rule</span><span class='period'>.</span><span class='id identifier rubyid_declarations'>declarations</span><span class='rparen'>)</span><span class='comma'>,</span>
        <span class='label'>media_types:</span> <span class='id identifier rubyid_group_media_types'>group_media_types</span><span class='comma'>,</span>
        <span class='label'>specificity:</span> <span class='id identifier rubyid_rule'>rule</span><span class='period'>.</span><span class='id identifier rubyid_specificity'>specificity</span>
      <span class='rparen'>)</span>
      <span class='kw'>yield</span> <span class='id identifier rubyid_rule_set'>rule_set</span><span class='comma'>,</span> <span class='id identifier rubyid_group_media_types'>group_media_types</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="each_selector-instance_method">
  
    #<strong>each_selector</strong>(media: :all, specificity: nil, property: nil, property_value: nil) {|selector, declarations, specificity, media_types| ... } &#x21d2; <tt>Enumerator</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Iterate over each selector in the stylesheet with optional filtering.</p>

<p>This is the primary method for querying CSS rules. It yields each selector along with its declarations, specificity, and media types. Supports powerful filtering by media type, specificity, property name, and property value.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Iterate all selectors</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_each_selector'>each_selector</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_sel'>sel</span><span class='comma'>,</span> <span class='id identifier rubyid_decls'>decls</span><span class='comma'>,</span> <span class='id identifier rubyid_spec'>spec</span><span class='comma'>,</span> <span class='id identifier rubyid_media'>media</span><span class='op'>|</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_sel'>sel</span><span class='embexpr_end'>}</span><span class='tstring_content'>: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_decls'>decls</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>color</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Access declaration properties</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_each_selector'>each_selector</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_sel'>sel</span><span class='comma'>,</span> <span class='id identifier rubyid_decls'>decls</span><span class='comma'>,</span> <span class='id identifier rubyid_spec'>spec</span><span class='comma'>,</span> <span class='id identifier rubyid_media'>media</span><span class='op'>|</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_decls'>decls</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>color</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>        <span class='comment'># Get value
</span>  <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_decls'>decls</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>margin</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>  <span class='comment'># Check existence
</span>  <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_decls'>decls</span><span class='period'>.</span><span class='id identifier rubyid_important?'>important?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>color</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>  <span class='comment'># Check !important
</span><span class='kw'>end</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Filter by media type</p>
</div></h5>
      
      <pre class="example code"><code>sheet.each_selector(media: :print) { |sel, decls, spec, media| ... }</code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Filter by exact specificity</p>
</div></h5>
      
      <pre class="example code"><code>sheet.each_selector(specificity: 10) { |sel, decls, spec, media| ... }</code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Filter by minimum specificity (using Range)</p>
</div></h5>
      
      <pre class="example code"><code>sheet.each_selector(specificity: 100..) { |sel, decls, spec, media| ... }</code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Find selectors with a specific property</p>
</div></h5>
      
      <pre class="example code"><code>sheet.each_selector(property: &#39;color&#39;) { |sel, decls, spec, media| ... }</code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Find selectors with a specific value</p>
</div></h5>
      
      <pre class="example code"><code>sheet.each_selector(property_value: &#39;relative&#39;) { |sel, decls, spec, media| ... }</code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Iterate over declaration properties</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_each_selector'>each_selector</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_sel'>sel</span><span class='comma'>,</span> <span class='id identifier rubyid_decls'>decls</span><span class='comma'>,</span> <span class='id identifier rubyid_spec'>spec</span><span class='comma'>,</span> <span class='id identifier rubyid_media'>media</span><span class='op'>|</span>
  <span class='id identifier rubyid_decls'>decls</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_prop'>prop</span><span class='comma'>,</span> <span class='id identifier rubyid_val'>val</span><span class='comma'>,</span> <span class='id identifier rubyid_important'>important</span><span class='op'>|</span> <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_prop'>prop</span><span class='embexpr_end'>}</span><span class='tstring_content'>: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_val'>val</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
<span class='kw'>end</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Combine filters</p>
</div></h5>
      
      <pre class="example code"><code>sheet.each_selector(property: &#39;position&#39;, property_value: &#39;relative&#39;) { |sel, decls, spec, media| ... }</code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Complex filter with multiple criteria</p>
</div></h5>
      
      <pre class="example code"><code>sheet.each_selector(property: &#39;color&#39;, specificity: 100.., media: :print) { |sel, decls, spec, media| ... }</code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Use as Enumerator</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_selectors'>selectors</span> <span class='op'>=</span> <span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_each_selector'>each_selector</span><span class='lparen'>(</span><span class='label'>media:</span> <span class='symbol'>:print</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>media</span>
      
      
        <span class='type'>(<tt>Symbol</tt>, <tt>Array&lt;Symbol&gt;</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>:all</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Media type(s) to filter by (default: :all) Use :all for all media types, or filter by :screen, :print, etc.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>specificity</span>
      
      
        <span class='type'>(<tt>Integer</tt>, <tt>Range</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Filter by specificity value Pass an integer for exact match, or a Range like 100.. for minimum specificity</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>property</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Filter by CSS property name (e.g., ‘color’, ‘position’) Only yields selectors that have this property</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>property_value</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Filter by CSS property value (e.g., ‘relative’, ‘red’) Only yields selectors that have this value (for any property)</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'>(<tt>selector</tt>, <tt><span class='object_link'><a href="#declarations-instance_method" title="Cataract::Stylesheet#declarations (method)">declarations</a></span></tt>, <tt>specificity</tt>, <tt>media_types</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Yields for each matching rule</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>selector</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The CSS selector (e.g., “body”, “.class”, “#id”)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>declarations</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Declarations.html" title="Cataract::Declarations (class)">Declarations</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Declarations object with all CSS properties</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>specificity</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Specificity value (higher = more specific)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>media_types</span>
      
      
        <span class='type'>(<tt>Array&lt;Symbol&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Media types for this rule (e.g., [:screen, :print])</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Enumerator</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>If no block given, returns an Enumerator</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#find_by_selector-instance_method" title="Cataract::Stylesheet#find_by_selector (method)">For simpler selector lookup</a></span></li>
    
      <li><span class='object_link'><a href="Declarations.html" title="Cataract::Declarations (class)">For the declarations object API</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cataract/stylesheet.rb', line 300</span>

<span class='kw'>def</span> <span class='id identifier rubyid_each_selector'>each_selector</span><span class='lparen'>(</span><span class='label'>media:</span> <span class='symbol'>:all</span><span class='comma'>,</span> <span class='label'>specificity:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>property:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>property_value:</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_enum_for'>enum_for</span><span class='lparen'>(</span><span class='symbol'>:each_selector</span><span class='comma'>,</span> <span class='label'>media:</span> <span class='id identifier rubyid_media'>media</span><span class='comma'>,</span> <span class='label'>specificity:</span> <span class='id identifier rubyid_specificity'>specificity</span><span class='comma'>,</span> <span class='label'>property:</span> <span class='id identifier rubyid_property'>property</span><span class='comma'>,</span>
                                    <span class='label'>property_value:</span> <span class='id identifier rubyid_property_value'>property_value</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_query_media_types'>query_media_types</span> <span class='op'>=</span> <span class='const'>Array</span><span class='lparen'>(</span><span class='id identifier rubyid_media'>media</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:to_sym</span><span class='rparen'>)</span>

  <span class='ivar'>@rule_groups</span><span class='period'>.</span><span class='id identifier rubyid_each_value'>each_value</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_group'>group</span><span class='op'>|</span>
    <span class='comment'># Filter by media types at group level
</span>    <span class='id identifier rubyid_group_media_types'>group_media_types</span> <span class='op'>=</span> <span class='id identifier rubyid_group'>group</span><span class='lbracket'>[</span><span class='symbol'>:media_types</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

    <span class='comment'># :all matches everything
</span>    <span class='comment'># But specific media queries (like :screen, :print) should NOT match [:all] groups
</span>    <span class='id identifier rubyid_should_include'>should_include</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_query_media_types'>query_media_types</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='symbol'>:all</span><span class='rparen'>)</span>
                       <span class='comment'># :all means iterate everything
</span>                       <span class='kw'>true</span>
                     <span class='kw'>elsif</span> <span class='id identifier rubyid_group_media_types'>group_media_types</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='symbol'>:all</span><span class='rparen'>)</span>
                       <span class='comment'># Group is universal (no media query) - only include if querying for :all
</span>                       <span class='kw'>false</span>
                     <span class='kw'>else</span>
                       <span class='comment'># Check for intersection
</span>                       <span class='id identifier rubyid_group_media_types'>group_media_types</span><span class='period'>.</span><span class='id identifier rubyid_intersect?'>intersect?</span><span class='lparen'>(</span><span class='id identifier rubyid_query_media_types'>query_media_types</span><span class='rparen'>)</span>
                     <span class='kw'>end</span>

    <span class='kw'>next</span> <span class='kw'>unless</span> <span class='id identifier rubyid_should_include'>should_include</span>

    <span class='id identifier rubyid_group'>group</span><span class='lbracket'>[</span><span class='symbol'>:rules</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_rule'>rule</span><span class='op'>|</span>
      <span class='comment'># Filter by specificity if provided
</span>      <span class='kw'>if</span> <span class='id identifier rubyid_specificity'>specificity</span>
        <span class='id identifier rubyid_rule_specificity'>rule_specificity</span> <span class='op'>=</span> <span class='id identifier rubyid_rule'>rule</span><span class='period'>.</span><span class='id identifier rubyid_specificity'>specificity</span>
        <span class='id identifier rubyid_matches'>matches</span> <span class='op'>=</span> <span class='kw'>case</span> <span class='id identifier rubyid_specificity'>specificity</span>
                  <span class='kw'>when</span> <span class='const'>Range</span>
                    <span class='id identifier rubyid_specificity'>specificity</span><span class='period'>.</span><span class='id identifier rubyid_cover?'>cover?</span><span class='lparen'>(</span><span class='id identifier rubyid_rule_specificity'>rule_specificity</span><span class='rparen'>)</span>
                  <span class='kw'>else</span>
                    <span class='id identifier rubyid_specificity'>specificity</span> <span class='op'>==</span> <span class='id identifier rubyid_rule_specificity'>rule_specificity</span>
                  <span class='kw'>end</span>
        <span class='kw'>next</span> <span class='kw'>unless</span> <span class='id identifier rubyid_matches'>matches</span>
      <span class='kw'>end</span>

      <span class='comment'># Filter by property and/or property_value if provided
</span>      <span class='kw'>if</span> <span class='id identifier rubyid_property'>property</span> <span class='op'>||</span> <span class='id identifier rubyid_property_value'>property_value</span>
        <span class='id identifier rubyid_has_match'>has_match</span> <span class='op'>=</span> <span class='kw'>false</span>

        <span class='id identifier rubyid_rule'>rule</span><span class='period'>.</span><span class='id identifier rubyid_declarations'>declarations</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_decl'>decl</span><span class='op'>|</span>
          <span class='comment'># Check property name match (if specified)
</span>          <span class='id identifier rubyid_property_matches'>property_matches</span> <span class='op'>=</span> <span class='id identifier rubyid_property'>property</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='id identifier rubyid_decl'>decl</span><span class='period'>.</span><span class='id identifier rubyid_property'>property</span> <span class='op'>==</span> <span class='id identifier rubyid_property'>property</span>

          <span class='comment'># Check property value match (if specified)
</span>          <span class='comment'># Compare against raw value (without !important flag)
</span>          <span class='id identifier rubyid_value_matches'>value_matches</span> <span class='op'>=</span> <span class='id identifier rubyid_property_value'>property_value</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='id identifier rubyid_decl'>decl</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span> <span class='op'>==</span> <span class='id identifier rubyid_property_value'>property_value</span>

          <span class='comment'># If both filters specified, both must match
</span>          <span class='comment'># If only one specified, just that one must match
</span>          <span class='kw'>if</span> <span class='id identifier rubyid_property_matches'>property_matches</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_value_matches'>value_matches</span>
            <span class='id identifier rubyid_has_match'>has_match</span> <span class='op'>=</span> <span class='kw'>true</span>
            <span class='kw'>break</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>

        <span class='kw'>next</span> <span class='kw'>unless</span> <span class='id identifier rubyid_has_match'>has_match</span>
      <span class='kw'>end</span>

      <span class='comment'># Wrap declarations in Declarations object for user-facing API
</span>      <span class='id identifier rubyid_declarations_obj'>declarations_obj</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Declarations.html" title="Cataract::Declarations (class)">Declarations</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Declarations.html#initialize-instance_method" title="Cataract::Declarations#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_rule'>rule</span><span class='period'>.</span><span class='id identifier rubyid_declarations'>declarations</span><span class='rparen'>)</span>

      <span class='comment'># Return the group&#39;s media_types, not from the rule
</span>      <span class='kw'>yield</span> <span class='id identifier rubyid_rule'>rule</span><span class='period'>.</span><span class='id identifier rubyid_selector'>selector</span><span class='comma'>,</span> <span class='id identifier rubyid_declarations_obj'>declarations_obj</span><span class='comma'>,</span> <span class='id identifier rubyid_rule'>rule</span><span class='period'>.</span><span class='id identifier rubyid_specificity'>specificity</span><span class='comma'>,</span> <span class='id identifier rubyid_group'>group</span><span class='lbracket'>[</span><span class='symbol'>:media_types</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="empty?-instance_method">
  
    #<strong>empty?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Check if the stylesheet has no rules.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Check if empty</p>
</div></h5>
      
      <pre class="example code"><code><span class='const'><span class='object_link'><a href="" title="Cataract::Stylesheet (class)">Stylesheet</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="#initialize-instance_method" title="Cataract::Stylesheet#initialize (method)">new</a></span></span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='comment'>#=&gt; true
</span><span class='const'><span class='object_link'><a href="" title="Cataract::Stylesheet (class)">Stylesheet</a></span></span><span class='period'>.</span><span class='id identifier rubyid_parse'><span class='object_link'><a href="#parse-class_method" title="Cataract::Stylesheet.parse (method)">parse</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>body { color: red; }</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='comment'>#=&gt; false</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>true if stylesheet has no rules, false otherwise</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#size-instance_method" title="Cataract::Stylesheet#size (method)">For getting the number of rules</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


879
880
881</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cataract/stylesheet.rb', line 879</span>

<span class='kw'>def</span> <span class='id identifier rubyid_empty?'>empty?</span>
  <span class='ivar'>@rule_groups</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='op'>||</span> <span class='ivar'>@rule_groups</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_all?'>all?</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_group'>group</span><span class='op'>|</span> <span class='id identifier rubyid_group'>group</span><span class='lbracket'>[</span><span class='symbol'>:rules</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="find_by_selector-instance_method">
  
    #<strong>find_by_selector</strong>(selector, media_types = :all)  &#x21d2; <tt>Array&lt;<span class='object_link'><a href="Declarations.html" title="Cataract::Declarations (class)">Declarations</a></span>&gt;</tt> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='[]-instance_method'>[]</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Find all declaration blocks for a specific selector.</p>

<p>Searches the stylesheet for rules matching the exact selector and returns an array of Declarations objects. Useful for finding what styles apply to a specific selector.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Find styles for an ID selector</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_decls'>decls</span> <span class='op'>=</span> <span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_find_by_selector'>find_by_selector</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>#content</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
<span class='id identifier rubyid_decls'>decls</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>font-size</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>  <span class='comment'>#=&gt; &quot;13px&quot;
</span><span class='id identifier rubyid_decls'>decls</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>          <span class='comment'>#=&gt; &quot;font-size: 13px; line-height: 1.2;&quot;</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Find styles in specific media types</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_decls'>decls</span> <span class='op'>=</span> <span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_find_by_selector'>find_by_selector</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>#content</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='symbol'>:screen</span><span class='comma'>,</span> <span class='symbol'>:handheld</span><span class='rbracket'>]</span><span class='rparen'>)</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Check if property exists</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_decls'>decls</span> <span class='op'>=</span> <span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_find_by_selector'>find_by_selector</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>body</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
<span class='id identifier rubyid_decls'>decls</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>color</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>  <span class='comment'>#=&gt; true</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Using array access syntax (alias)</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>#content</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>  <span class='comment'>#=&gt; [#&lt;Declarations...&gt;]</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>selector</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The CSS selector to search for (must match exactly)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>media_types</span>
      
      
        <span class='type'>(<tt>Symbol</tt>, <tt>Array&lt;Symbol&gt;</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>:all</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Media type(s) to filter by (default: :all) Use :all to search all media queries, or specify :screen, :print, etc.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="Declarations.html" title="Cataract::Declarations (class)">Declarations</a></span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Array of Declarations objects Returns empty array if selector not found.</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#each_selector-instance_method" title="Cataract::Stylesheet#each_selector (method)">For more advanced filtering options</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


225
226
227
228
229
230
231
232
233</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cataract/stylesheet.rb', line 225</span>

<span class='kw'>def</span> <span class='id identifier rubyid_find_by_selector'>find_by_selector</span><span class='lparen'>(</span><span class='id identifier rubyid_selector'>selector</span><span class='comma'>,</span> <span class='id identifier rubyid_media_types'>media_types</span> <span class='op'>=</span> <span class='symbol'>:all</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_matching_declarations'>matching_declarations</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_each_selector'>each_selector</span><span class='lparen'>(</span><span class='label'>media:</span> <span class='id identifier rubyid_media_types'>media_types</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_sel'>sel</span><span class='comma'>,</span> <span class='id identifier rubyid_declarations'>declarations</span><span class='comma'>,</span> <span class='id identifier rubyid__specificity'>_specificity</span><span class='comma'>,</span> <span class='id identifier rubyid__media'>_media</span><span class='op'>|</span>
    <span class='id identifier rubyid_matching_declarations'>matching_declarations</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_declarations'>declarations</span> <span class='kw'>if</span> <span class='id identifier rubyid_sel'>sel</span> <span class='op'>==</span> <span class='id identifier rubyid_selector'>selector</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_matching_declarations'>matching_declarations</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="find_rule_sets-instance_method">
  
    #<strong>find_rule_sets</strong>(selectors, media_types = :all)  &#x21d2; <tt>Array&lt;<span class='object_link'><a href="RuleSet.html" title="Cataract::RuleSet (class)">RuleSet</a></span>&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Find RuleSets matching any of the given selectors.</p>

<p>Searches the stylesheet for rules with selectors that match any of the provided selectors. Selectors are normalized (whitespace is collapsed) before comparison.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Find rules for a selector</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_find_rule_sets'>find_rule_sets</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>body</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='comment'>#=&gt; [#&lt;RuleSet selector=&quot;body&quot; ...&gt;]</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Find rules for multiple selectors</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_find_rule_sets'>find_rule_sets</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>body</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>h1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>p</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
<span class='comment'>#=&gt; [#&lt;RuleSet ...&gt;, #&lt;RuleSet ...&gt;, ...]</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Filter by media type</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_find_rule_sets'>find_rule_sets</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>body</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>h1</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='symbol'>:print</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>selectors</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Selector(s) to search for Can be a single selector string or an array of selectors</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>media_types</span>
      
      
        <span class='type'>(<tt>Symbol</tt>, <tt>Array&lt;Symbol&gt;</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>:all</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Media type(s) to filter by (default: :all)</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="RuleSet.html" title="Cataract::RuleSet (class)">RuleSet</a></span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Array of matching RuleSet objects (no duplicates)</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#find_by_selector-instance_method" title="Cataract::Stylesheet#find_by_selector (method)">For finding declaration strings</a></span></li>
    
      <li><span class='object_link'><a href="#each_rule_set-instance_method" title="Cataract::Stylesheet#each_rule_set (method)">For iterating all RuleSets</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1023
1024
1025
1026
1027
1028
1029
1030
1031
1032
1033
1034
1035
1036
1037</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cataract/stylesheet.rb', line 1023</span>

<span class='kw'>def</span> <span class='id identifier rubyid_find_rule_sets'>find_rule_sets</span><span class='lparen'>(</span><span class='id identifier rubyid_selectors'>selectors</span><span class='comma'>,</span> <span class='id identifier rubyid_media_types'>media_types</span> <span class='op'>=</span> <span class='symbol'>:all</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_rule_sets'>rule_sets</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='comment'># Normalize selectors for comparison
</span>  <span class='id identifier rubyid_normalized_selectors'>normalized_selectors</span> <span class='op'>=</span> <span class='const'>Array</span><span class='lparen'>(</span><span class='id identifier rubyid_selectors'>selectors</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_s'>s</span><span class='op'>|</span> <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\s+</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> </span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_strip'>strip</span> <span class='rbrace'>}</span>

  <span class='id identifier rubyid_each_rule_set'>each_rule_set</span><span class='lparen'>(</span><span class='id identifier rubyid_media_types'>media_types</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_rule_set'>rule_set</span><span class='comma'>,</span> <span class='id identifier rubyid__media_types'>_media_types</span><span class='op'>|</span>
    <span class='comment'># Normalize the rule set&#39;s selector for comparison
</span>    <span class='id identifier rubyid_normalized_rule_selector'>normalized_rule_selector</span> <span class='op'>=</span> <span class='id identifier rubyid_rule_set'>rule_set</span><span class='period'>.</span><span class='id identifier rubyid_selector'>selector</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\s+</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> </span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_strip'>strip</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_normalized_selectors'>normalized_selectors</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_normalized_rule_selector'>normalized_rule_selector</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_rule_sets'>rule_sets</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_rule_set'>rule_set</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_rule_sets'>rule_sets</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_rule_set'>rule_set</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_rule_sets'>rule_sets</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="inspect-instance_method">
  
    #<strong>inspect</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1099
1100
1101
1102
1103
1104
1105
1106
1107
1108
1109
1110
1111
1112
1113
1114
1115</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cataract/stylesheet.rb', line 1099</span>

<span class='kw'>def</span> <span class='id identifier rubyid_inspect'>inspect</span>
  <span class='id identifier rubyid_total_rules'>total_rules</span> <span class='op'>=</span> <span class='id identifier rubyid_size'>size</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_total_rules'>total_rules</span><span class='period'>.</span><span class='id identifier rubyid_zero?'>zero?</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>#&lt;Cataract::Stylesheet empty&gt;</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>else</span>
    <span class='comment'># Get first 3 rules across all groups
</span>    <span class='id identifier rubyid_preview_rules'>preview_rules</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='ivar'>@rule_groups</span><span class='period'>.</span><span class='id identifier rubyid_each_value'>each_value</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_group'>group</span><span class='op'>|</span>
      <span class='id identifier rubyid_preview_rules'>preview_rules</span><span class='period'>.</span><span class='id identifier rubyid_concat'>concat</span><span class='lparen'>(</span><span class='id identifier rubyid_group'>group</span><span class='lbracket'>[</span><span class='symbol'>:rules</span><span class='rbracket'>]</span><span class='rparen'>)</span>
      <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_preview_rules'>preview_rules</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&gt;=</span> <span class='int'>3</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_preview'>preview</span> <span class='op'>=</span> <span class='id identifier rubyid_preview_rules'>preview_rules</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='lparen'>(</span><span class='int'>3</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:selector</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>, </span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_more'>more</span> <span class='op'>=</span> <span class='id identifier rubyid_total_rules'>total_rules</span> <span class='op'>&gt;</span> <span class='int'>3</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>, ...</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_resolved_info'>resolved_info</span> <span class='op'>=</span> <span class='ivar'>@resolved</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>, </span><span class='embexpr_beg'>#{</span><span class='ivar'>@resolved</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='embexpr_end'>}</span><span class='tstring_content'> declarations resolved</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>#&lt;Cataract::Stylesheet </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_total_rules'>total_rules</span><span class='embexpr_end'>}</span><span class='tstring_content'> rules: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_preview'>preview</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_more'>more</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_resolved_info'>resolved_info</span><span class='embexpr_end'>}</span><span class='tstring_content'>&gt;</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="load_file-instance_method">
  
    #<strong>load_file</strong>(filename, base_dir = &#39;.&#39;, _media_types = :all)  &#x21d2; <tt>self</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Load CSS from a local file and add to this stylesheet.</p>

<p>Reads the file and parses its contents. If import resolution is enabled (via constructor options), the file’s directory is used as the base path for resolving relative @import statements.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Load a CSS file</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Cataract::Stylesheet (class)">Stylesheet</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="#initialize-instance_method" title="Cataract::Stylesheet#initialize (method)">new</a></span></span>
<span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_load_file'>load_file</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>style.css</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Load with relative base directory</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_load_file'>load_file</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>components/button.css</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>assets/css</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='comment'># Loads from assets/css/components/button.css</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Load multiple files</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_load_file'>load_file</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>base.css</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_load_file'>load_file</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>theme.css</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_load_file'>load_file</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>responsive.css</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>filename</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Path to the CSS file</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>base_dir</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;.&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Base directory for resolving the filename (default: ‘.’) The filename is resolved relative to this directory</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>_media_types</span>
      
      
        <span class='type'>(<tt>Symbol</tt>, <tt>Array&lt;Symbol&gt;</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>:all</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Media types (not currently implemented, reserved for future use)</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>self</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Returns self for method chaining</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>IOError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>If the file doesn’t exist and io_exceptions is enabled</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#load_file-class_method" title="Cataract::Stylesheet.load_file (method)">Class method that creates a new stylesheet</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


789
790
791
792
793
794
795
796</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cataract/stylesheet.rb', line 789</span>

<span class='kw'>def</span> <span class='id identifier rubyid_load_file'>load_file</span><span class='lparen'>(</span><span class='id identifier rubyid_filename'>filename</span><span class='comma'>,</span> <span class='id identifier rubyid_base_dir'>base_dir</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid__media_types'>_media_types</span> <span class='op'>=</span> <span class='symbol'>:all</span><span class='rparen'>)</span>
  <span class='comment'># Normalize file path and convert to file:// URI
</span>  <span class='id identifier rubyid_file_path'>file_path</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_expand_path'>expand_path</span><span class='lparen'>(</span><span class='id identifier rubyid_filename'>filename</span><span class='comma'>,</span> <span class='id identifier rubyid_base_dir'>base_dir</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_file_uri'>file_uri</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>file://</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_file_path'>file_path</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>

  <span class='comment'># Delegate to load_uri which handles imports and base_path
</span>  <span class='id identifier rubyid_load_uri'>load_uri</span><span class='lparen'>(</span><span class='id identifier rubyid_file_uri'>file_uri</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="load_uri-instance_method">
  
    #<strong>load_uri</strong>(uri, options = {})  &#x21d2; <tt>self</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Load CSS from a URI and add to this stylesheet.</p>

<p>Supports http://, https://, and file:// URIs. Network requests follow redirects and have a timeout. If the stylesheet was created with import resolution enabled, the URI’s directory will be used as the base path.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Load from HTTPS</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Cataract::Stylesheet (class)">Stylesheet</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="#initialize-instance_method" title="Cataract::Stylesheet#initialize (method)">new</a></span></span>
<span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_load_uri'>load_uri</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>https://example.com/style.css</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Load local file via file:// URI</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_load_uri'>load_uri</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>file:///path/to/style.css</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Load multiple URIs</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_load_uri'>load_uri</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>https://example.com/base.css</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_load_uri'>load_uri</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>https://example.com/theme.css</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>uri</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>URI to load CSS from (http://, https://, or file://)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Additional options</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>options</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:base_uri</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Base URI for resolving relative imports (deprecated)</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:media_types</span>
          <span class="type">(<tt>Symbol</tt>, <tt>Array&lt;Symbol&gt;</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Media types (not currently implemented)</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>self</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Returns self for method chaining</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>IOError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>If the URI can’t be loaded and io_exceptions is enabled</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt>ArgumentError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>If the URI scheme is not supported</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#load_uri-class_method" title="Cataract::Stylesheet.load_uri (method)">Class method that creates a new stylesheet</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


713
714
715
716
717
718
719
720
721
722
723
724
725
726
727
728
729
730
731
732
733
734
735
736
737
738
739
740
741
742
743
744
745
746
747
748
749
750
751
752
753
754
755
756
757
758
759
760</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cataract/stylesheet.rb', line 713</span>

<span class='kw'>def</span> <span class='id identifier rubyid_load_uri'>load_uri</span><span class='lparen'>(</span><span class='id identifier rubyid_uri'>uri</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uri</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>net/http</span><span class='tstring_end'>&#39;</span></span>

  <span class='id identifier rubyid_uri_obj'>uri_obj</span> <span class='op'>=</span> <span class='const'>URI</span><span class='lparen'>(</span><span class='id identifier rubyid_uri'>uri</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_css_content'>css_content</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_file_path'>file_path</span> <span class='op'>=</span> <span class='kw'>nil</span>

  <span class='kw'>case</span> <span class='id identifier rubyid_uri_obj'>uri_obj</span><span class='period'>.</span><span class='id identifier rubyid_scheme'>scheme</span>
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>http</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>https</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_response'>response</span> <span class='op'>=</span> <span class='const'>Net</span><span class='op'>::</span><span class='const'>HTTP</span><span class='period'>.</span><span class='id identifier rubyid_get_response'>get_response</span><span class='lparen'>(</span><span class='id identifier rubyid_uri_obj'>uri_obj</span><span class='rparen'>)</span>
    <span class='kw'>unless</span> <span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Net</span><span class='op'>::</span><span class='const'>HTTPSuccess</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>IOError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Failed to load URI: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_uri'>uri</span><span class='embexpr_end'>}</span><span class='tstring_content'> (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_code'>code</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_css_content'>css_content</span> <span class='op'>=</span> <span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_body'>body</span>
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>file</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>nil</span>
    <span class='comment'># file:// URI or relative path
</span>    <span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='id identifier rubyid_uri_obj'>uri_obj</span><span class='period'>.</span><span class='id identifier rubyid_scheme'>scheme</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>file</span><span class='tstring_end'>&#39;</span></span> <span class='op'>?</span> <span class='id identifier rubyid_uri_obj'>uri_obj</span><span class='period'>.</span><span class='id identifier rubyid_path'>path</span> <span class='op'>:</span> <span class='id identifier rubyid_uri'>uri</span>
    <span class='comment'># Handle base_uri if provided
</span>    <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:base_uri</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_base'>base</span> <span class='op'>=</span> <span class='const'>URI</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:base_uri</span><span class='rbracket'>]</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_base'>base</span><span class='period'>.</span><span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_base'>base</span><span class='period'>.</span><span class='id identifier rubyid_scheme'>scheme</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>file</span><span class='tstring_end'>&#39;</span></span> <span class='op'>||</span> <span class='id identifier rubyid_base'>base</span><span class='period'>.</span><span class='id identifier rubyid_scheme'>scheme</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_file_path'>file_path</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_expand_path'>expand_path</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>

    <span class='comment'># If imports are enabled and base_path not already set, set it for resolving relative imports
</span>    <span class='kw'>if</span> <span class='ivar'>@options</span><span class='lbracket'>[</span><span class='symbol'>:import</span><span class='rbracket'>]</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@options</span><span class='lbracket'>[</span><span class='symbol'>:import</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:base_path</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
      <span class='id identifier rubyid_file_dir'>file_dir</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_dirname'>dirname</span><span class='lparen'>(</span><span class='id identifier rubyid_file_path'>file_path</span><span class='rparen'>)</span>
      <span class='ivar'>@options</span><span class='lbracket'>[</span><span class='symbol'>:import</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='ivar'>@options</span><span class='lbracket'>[</span><span class='symbol'>:import</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='label'>base_path:</span> <span class='id identifier rubyid_file_dir'>file_dir</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_css_content'>css_content</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='id identifier rubyid_file_path'>file_path</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Unsupported URI scheme: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_uri_obj'>uri_obj</span><span class='period'>.</span><span class='id identifier rubyid_scheme'>scheme</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_css_content'>css_content</span><span class='rparen'>)</span>
  <span class='kw'>self</span>
<span class='kw'>rescue</span> <span class='const'>Errno</span><span class='op'>::</span><span class='const'>ENOENT</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>IOError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>File not found: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_uri'>uri</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='ivar'>@options</span><span class='lbracket'>[</span><span class='symbol'>:io_exceptions</span><span class='rbracket'>]</span>

  <span class='kw'>self</span>
<span class='kw'>rescue</span> <span class='const'>StandardError</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>IOError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Error loading URI: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_uri'>uri</span><span class='embexpr_end'>}</span><span class='tstring_content'> - </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='ivar'>@options</span><span class='lbracket'>[</span><span class='symbol'>:io_exceptions</span><span class='rbracket'>]</span>

  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="parse-instance_method">
  
    #<strong>parse</strong>(css_string)  &#x21d2; <tt>self</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Parse CSS and merge into this stylesheet.</p>

<p>Parses the CSS string and adds all rules to this stylesheet. If @import resolution is enabled (via constructor options), imports will be resolved before parsing.</p>

<p>This method can be called multiple times to parse and accumulate CSS from multiple sources into the same stylesheet.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Parse CSS into existing stylesheet</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Cataract::Stylesheet (class)">Stylesheet</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="#initialize-instance_method" title="Cataract::Stylesheet#initialize (method)">new</a></span></span>
<span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>body { color: red; }</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>h1 { color: blue; }</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='comment'>#=&gt; 2</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Method chaining</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Cataract::Stylesheet (class)">Stylesheet</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="#initialize-instance_method" title="Cataract::Stylesheet#initialize (method)">new</a></span></span><span class='period'>.</span><span class='id identifier rubyid_parse'><span class='object_link'><a href="#parse-class_method" title="Cataract::Stylesheet.parse (method)">parse</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>body { color: red; }</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_parse'><span class='object_link'><a href="#parse-class_method" title="Cataract::Stylesheet.parse (method)">parse</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>h1 { color: blue; }</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>css_string</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The CSS string to parse</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>self</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Returns self for method chaining</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>IOError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>If import resolution fails and io_exceptions is enabled</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#parse-class_method" title="Cataract::Stylesheet.parse (method)">Class method that creates a new stylesheet</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cataract/stylesheet.rb', line 172</span>

<span class='kw'>def</span> <span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_css_string'>css_string</span><span class='rparen'>)</span>
  <span class='comment'># Resolve @import statements if configured in constructor
</span>  <span class='id identifier rubyid_css_to_parse'>css_to_parse</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='ivar'>@options</span><span class='lbracket'>[</span><span class='symbol'>:import</span><span class='rbracket'>]</span>
                   <span class='const'><span class='object_link'><a href="ImportResolver.html" title="Cataract::ImportResolver (module)">ImportResolver</a></span></span><span class='period'>.</span><span class='id identifier rubyid_resolve'><span class='object_link'><a href="ImportResolver.html#resolve-class_method" title="Cataract::ImportResolver.resolve (method)">resolve</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_css_string'>css_string</span><span class='comma'>,</span> <span class='ivar'>@options</span><span class='lbracket'>[</span><span class='symbol'>:import</span><span class='rbracket'>]</span><span class='rparen'>)</span>
                 <span class='kw'>else</span>
                   <span class='id identifier rubyid_css_string'>css_string</span>
                 <span class='kw'>end</span>

  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Cataract.html" title="Cataract (module)">Cataract</a></span></span><span class='period'>.</span><span class='id identifier rubyid_parse_css_internal'><span class='object_link'><a href="../Cataract.html#parse_css_internal-class_method" title="Cataract.parse_css_internal (method)">parse_css_internal</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_css_to_parse'>css_to_parse</span><span class='rparen'>)</span>
  <span class='comment'># parse_css_internal returns {rules: {query_string =&gt; {media_types: [...], rules: [...]}}, charset: &quot;...&quot; | nil}
</span>
  <span class='comment'># Store charset if not already set
</span>  <span class='ivar'>@charset</span> <span class='op'>||=</span> <span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='symbol'>:charset</span><span class='rbracket'>]</span>

  <span class='comment'># Merge: if key exists, concatenate rules arrays; otherwise just add
</span>  <span class='ivar'>@rule_groups</span><span class='period'>.</span><span class='id identifier rubyid_merge!'>merge!</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='symbol'>:rules</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid__key'>_key</span><span class='comma'>,</span> <span class='id identifier rubyid_old_group'>old_group</span><span class='comma'>,</span> <span class='id identifier rubyid_new_group'>new_group</span><span class='op'>|</span>
    <span class='comment'># Merge rules arrays from both groups
</span>    <span class='lbrace'>{</span>
      <span class='label'>media_types:</span> <span class='id identifier rubyid_old_group'>old_group</span><span class='lbracket'>[</span><span class='symbol'>:media_types</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='comment'># Keep existing media types
</span>      <span class='label'>rules:</span> <span class='id identifier rubyid_old_group'>old_group</span><span class='lbracket'>[</span><span class='symbol'>:rules</span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='id identifier rubyid_new_group'>new_group</span><span class='lbracket'>[</span><span class='symbol'>:rules</span><span class='rbracket'>]</span>
    <span class='rbrace'>}</span>
  <span class='kw'>end</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="remove_rule_set!-instance_method">
  
    #<strong>remove_rule_set!</strong>(rule_set)  &#x21d2; <tt>self</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Remove a specific RuleSet from the stylesheet.</p>

<p>Removes rules that match both the selector and declarations of the given RuleSet. The comparison is exact - both selector and all declarations must match.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Remove a specific rule</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Cataract::Stylesheet (class)">Stylesheet</a></span></span><span class='period'>.</span><span class='id identifier rubyid_parse'><span class='object_link'><a href="#parse-class_method" title="Cataract::Stylesheet.parse (method)">parse</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>body { color: red; } h1 { color: blue; }</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_each_rule_set'>each_rule_set</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_rs'>rs</span><span class='comma'>,</span> <span class='id identifier rubyid__media'>_media</span><span class='op'>|</span>
  <span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_remove_rule_set!'>remove_rule_set!</span><span class='lparen'>(</span><span class='id identifier rubyid_rs'>rs</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_rs'>rs</span><span class='period'>.</span><span class='id identifier rubyid_selector'>selector</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>body</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>rule_set</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="RuleSet.html" title="Cataract::RuleSet (class)">RuleSet</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The RuleSet to remove</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>self</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Returns self for method chaining</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#remove_rules!-instance_method" title="Cataract::Stylesheet#remove_rules! (method)">For removing by criteria (more flexible)</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


623
624
625
626
627
628
629
630
631
632
633
634</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cataract/stylesheet.rb', line 623</span>

<span class='kw'>def</span> <span class='id identifier rubyid_remove_rule_set!'>remove_rule_set!</span><span class='lparen'>(</span><span class='id identifier rubyid_rule_set'>rule_set</span><span class='rparen'>)</span>
  <span class='comment'># Iterate through each media query group
</span>  <span class='ivar'>@rule_groups</span><span class='period'>.</span><span class='id identifier rubyid_each_value'>each_value</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_group'>group</span><span class='op'>|</span>
    <span class='id identifier rubyid_group'>group</span><span class='lbracket'>[</span><span class='symbol'>:rules</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_reject!'>reject!</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_rule'>rule</span><span class='op'>|</span>
      <span class='id identifier rubyid_rule'>rule</span><span class='period'>.</span><span class='id identifier rubyid_selector'>selector</span> <span class='op'>==</span> <span class='id identifier rubyid_rule_set'>rule_set</span><span class='period'>.</span><span class='id identifier rubyid_selector'>selector</span> <span class='op'>&amp;&amp;</span>
        <span class='id identifier rubyid_rule'>rule</span><span class='period'>.</span><span class='id identifier rubyid_declarations'>declarations</span> <span class='op'>==</span> <span class='id identifier rubyid_rule_set'>rule_set</span><span class='period'>.</span><span class='id identifier rubyid_declarations'>declarations</span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='comment'># Clean up empty groups
</span>  <span class='ivar'>@rule_groups</span><span class='period'>.</span><span class='id identifier rubyid_delete_if'>delete_if</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid__key'>_key</span><span class='comma'>,</span> <span class='id identifier rubyid_group'>group</span><span class='op'>|</span> <span class='id identifier rubyid_group'>group</span><span class='lbracket'>[</span><span class='symbol'>:rules</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='rbrace'>}</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="remove_rules!-instance_method">
  
    #<strong>remove_rules!</strong>(selector: nil, media_types: nil)  &#x21d2; <tt>self</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Remove rules matching the given criteria.</p>

<p>This is a flexible method for removing rules based on selector and/or media types. If multiple criteria are specified, rules must match ALL of them to be removed.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Remove all rules for a selector</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_remove_rules!'>remove_rules!</span><span class='lparen'>(</span><span class='label'>selector:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>body</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Remove all print rules</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_remove_rules!'>remove_rules!</span><span class='lparen'>(</span><span class='label'>media_types:</span> <span class='symbol'>:print</span><span class='rparen'>)</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Remove specific selector in specific media</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_remove_rules!'>remove_rules!</span><span class='lparen'>(</span><span class='label'>selector:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>#header</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>media_types:</span> <span class='symbol'>:screen</span><span class='rparen'>)</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Remove rules across multiple media types</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_remove_rules!'>remove_rules!</span><span class='lparen'>(</span><span class='label'>selector:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>.mobile-only</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>media_types:</span> <span class='lbracket'>[</span><span class='symbol'>:screen</span><span class='comma'>,</span> <span class='symbol'>:handheld</span><span class='rbracket'>]</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>selector</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>nil</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Selector to match (exact match required) If nil, selector is not used as a filter</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>media_types</span>
      
      
        <span class='type'>(<tt>Symbol</tt>, <tt>Array&lt;Symbol&gt;</tt>, <tt>nil</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Media type(s) to filter by If nil, all media types are searched Use :all to match rules with no media query</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>self</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Returns self for method chaining</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#remove_rule_set!-instance_method" title="Cataract::Stylesheet#remove_rule_set! (method)">For removing specific RuleSet objects</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


661
662
663
664
665
666
667
668
669
670
671
672
673
674
675
676
677
678
679
680
681
682
683
684
685</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cataract/stylesheet.rb', line 661</span>

<span class='kw'>def</span> <span class='id identifier rubyid_remove_rules!'>remove_rules!</span><span class='lparen'>(</span><span class='label'>selector:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>media_types:</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='comment'># Normalize media_types filter
</span>  <span class='id identifier rubyid_filter_media_types'>filter_media_types</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='const'>Array</span><span class='lparen'>(</span><span class='id identifier rubyid_media_types'>media_types</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:to_sym</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_media_types'>media_types</span><span class='rparen'>)</span>

  <span class='ivar'>@rule_groups</span><span class='period'>.</span><span class='id identifier rubyid_each_value'>each_value</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_group'>group</span><span class='op'>|</span>
    <span class='comment'># Skip groups that don&#39;t match media_types filter
</span>    <span class='kw'>if</span> <span class='id identifier rubyid_filter_media_types'>filter_media_types</span>
      <span class='id identifier rubyid_group_media_types'>group_media_types</span> <span class='op'>=</span> <span class='id identifier rubyid_group'>group</span><span class='lbracket'>[</span><span class='symbol'>:media_types</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
      <span class='comment'># Check if this group matches the filter
</span>      <span class='kw'>next</span> <span class='kw'>unless</span> <span class='id identifier rubyid_filter_media_types'>filter_media_types</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='symbol'>:all</span><span class='rparen'>)</span> <span class='op'>||</span>
                  <span class='id identifier rubyid_group_media_types'>group_media_types</span><span class='period'>.</span><span class='id identifier rubyid_intersect?'>intersect?</span><span class='lparen'>(</span><span class='id identifier rubyid_filter_media_types'>filter_media_types</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='comment'># Remove matching rules from this group
</span>    <span class='id identifier rubyid_group'>group</span><span class='lbracket'>[</span><span class='symbol'>:rules</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_reject!'>reject!</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_rule'>rule</span><span class='op'>|</span>
      <span class='id identifier rubyid_match'>match</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='id identifier rubyid_match'>match</span> <span class='op'>&amp;&amp;=</span> <span class='lparen'>(</span><span class='id identifier rubyid_rule'>rule</span><span class='period'>.</span><span class='id identifier rubyid_selector'>selector</span> <span class='op'>==</span> <span class='id identifier rubyid_selector'>selector</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_selector'>selector</span>
      <span class='id identifier rubyid_match'>match</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># Clean up empty groups
</span>  <span class='ivar'>@rule_groups</span><span class='period'>.</span><span class='id identifier rubyid_delete_if'>delete_if</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid__key'>_key</span><span class='comma'>,</span> <span class='id identifier rubyid_group'>group</span><span class='op'>|</span> <span class='id identifier rubyid_group'>group</span><span class='lbracket'>[</span><span class='symbol'>:rules</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='rbrace'>}</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="rules-instance_method">
  
    #<strong>rules</strong>(&amp;block)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


557
558
559
560
561
562
563
564</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cataract/stylesheet.rb', line 557</span>

<span class='kw'>def</span> <span class='id identifier rubyid_rules'>rules</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_enum_for'>enum_for</span><span class='lparen'>(</span><span class='symbol'>:rules</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_block_given?'>block_given?</span>

  <span class='comment'># Iterate over all rules in all media query groups
</span>  <span class='ivar'>@rule_groups</span><span class='period'>.</span><span class='id identifier rubyid_each_value'>each_value</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_group'>group</span><span class='op'>|</span>
    <span class='id identifier rubyid_group'>group</span><span class='lbracket'>[</span><span class='symbol'>:rules</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="selectors-instance_method">
  
    #<strong>selectors</strong>(media_types = :all)  &#x21d2; <tt>Array&lt;String&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Get array of all selectors, optionally filtered by media type.</p>

<p>Returns a flat array of all selectors in the stylesheet. Unlike each_selector, this does not return declarations or other metadata - just the selector strings.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Get all selectors</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Cataract::Stylesheet (class)">Stylesheet</a></span></span><span class='period'>.</span><span class='id identifier rubyid_parse'><span class='object_link'><a href="#parse-class_method" title="Cataract::Stylesheet.parse (method)">parse</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>body { color: red; } h1 { color: blue; }</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_selectors'>selectors</span> <span class='comment'>#=&gt; [&quot;body&quot;, &quot;h1&quot;]</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Get selectors for specific media</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_selectors'>selectors</span><span class='lparen'>(</span><span class='symbol'>:print</span><span class='rparen'>)</span> <span class='comment'>#=&gt; [&quot;body&quot;, &quot;h1&quot;, &quot;.print-only&quot;]</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Get selectors for multiple media types</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_selectors'>selectors</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='symbol'>:screen</span><span class='comma'>,</span> <span class='symbol'>:handheld</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='comment'>#=&gt; [&quot;.mobile&quot;, &quot;.desktop&quot;]</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>media_types</span>
      
      
        <span class='type'>(<tt>Symbol</tt>, <tt>Array&lt;Symbol&gt;</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>:all</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Media type(s) to filter by (default: :all) Use :all for all media types, or specify :screen, :print, etc.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Array of selector strings</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#each_selector-instance_method" title="Cataract::Stylesheet#each_selector (method)">For iterating with full rule information</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


926
927
928
929
930
931
932
933
934
935
936
937
938
939
940
941
942
943</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cataract/stylesheet.rb', line 926</span>

<span class='kw'>def</span> <span class='id identifier rubyid_selectors'>selectors</span><span class='lparen'>(</span><span class='id identifier rubyid_media_types'>media_types</span> <span class='op'>=</span> <span class='symbol'>:all</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_query_media_types'>query_media_types</span> <span class='op'>=</span> <span class='const'>Array</span><span class='lparen'>(</span><span class='id identifier rubyid_media_types'>media_types</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:to_sym</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

  <span class='ivar'>@rule_groups</span><span class='period'>.</span><span class='id identifier rubyid_each_value'>each_value</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_group'>group</span><span class='op'>|</span>
    <span class='comment'># Filter by media types at group level
</span>    <span class='id identifier rubyid_group_media_types'>group_media_types</span> <span class='op'>=</span> <span class='id identifier rubyid_group'>group</span><span class='lbracket'>[</span><span class='symbol'>:media_types</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

    <span class='comment'># :all matches everything
</span>    <span class='kw'>next</span> <span class='kw'>unless</span> <span class='id identifier rubyid_query_media_types'>query_media_types</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='symbol'>:all</span><span class='rparen'>)</span> <span class='op'>||</span>
                <span class='lparen'>(</span><span class='id identifier rubyid_group_media_types'>group_media_types</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_query_media_types'>query_media_types</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='symbol'>:all</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='op'>||</span>
                <span class='id identifier rubyid_group_media_types'>group_media_types</span><span class='period'>.</span><span class='id identifier rubyid_intersect?'>intersect?</span><span class='lparen'>(</span><span class='id identifier rubyid_query_media_types'>query_media_types</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_concat'>concat</span><span class='lparen'>(</span><span class='id identifier rubyid_group'>group</span><span class='lbracket'>[</span><span class='symbol'>:rules</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:selector</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="size-instance_method">
  
    #<strong>size</strong>  &#x21d2; <tt>Integer</tt> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='length-instance_method'>length</span>, <span id='rules_count-instance_method'>rules_count</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Get the total number of rules in the stylesheet.</p>

<p>Counts all rules across all media query groups.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Count rules</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Cataract::Stylesheet (class)">Stylesheet</a></span></span><span class='period'>.</span><span class='id identifier rubyid_parse'><span class='object_link'><a href="#parse-class_method" title="Cataract::Stylesheet.parse (method)">parse</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>body { color: red; } h1 { color: blue; }</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='comment'>#=&gt; 2</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Empty stylesheet</p>
</div></h5>
      
      <pre class="example code"><code><span class='const'><span class='object_link'><a href="" title="Cataract::Stylesheet (class)">Stylesheet</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="#initialize-instance_method" title="Cataract::Stylesheet#initialize (method)">new</a></span></span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='comment'>#=&gt; 0</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The total number of rules</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#empty%3F-instance_method" title="Cataract::Stylesheet#empty? (method)">For checking if stylesheet has no rules</a></span></li>
    
      <li><span class='object_link'><a href="#length-instance_method" title="Cataract::Stylesheet#length (method)">Alias for this method</a></span></li>
    
      <li><span class='object_link'><a href="#rules_count-instance_method" title="Cataract::Stylesheet#rules_count (method)">Alias for this method</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


864
865
866</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cataract/stylesheet.rb', line 864</span>

<span class='kw'>def</span> <span class='id identifier rubyid_size'>size</span>
  <span class='ivar'>@rule_groups</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_sum'>sum</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_group'>group</span><span class='op'>|</span> <span class='id identifier rubyid_group'>group</span><span class='lbracket'>[</span><span class='symbol'>:rules</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="to_formatted_s-instance_method">
  
    #<strong>to_formatted_s</strong>(which_media = :all)  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Serialize stylesheet to formatted CSS string with indentation.</p>

<p>Converts the stylesheet to CSS format with human-readable formatting:</p>
<ul><li>
<p>Each rule on its own line</p>
</li><li>
<p>Declarations indented with 2 spaces</p>
</li><li>
<p>Media queries properly formatted</p>
</li><li>
<p>Consistent spacing and line breaks</p>
</li></ul>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Serialize with formatting</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_to_formatted_s'>to_formatted_s</span>
<span class='comment'>#=&gt; &quot;body {\n  color: red;\n}\n\nh1 {\n  color: blue;\n}\n&quot;</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Format only print styles</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_to_formatted_s'>to_formatted_s</span><span class='lparen'>(</span><span class='symbol'>:print</span><span class='rparen'>)</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Format multiple media types</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_to_formatted_s'>to_formatted_s</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='symbol'>:screen</span><span class='comma'>,</span> <span class='symbol'>:handheld</span><span class='rbracket'>]</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>which_media</span>
      
      
        <span class='type'>(<tt>Symbol</tt>, <tt>Array&lt;Symbol&gt;</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>:all</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Media type filter (default: :all) When :all, outputs ALL rules regardless of media type When specified, only outputs rules for matching media types Can be an array to match multiple media types</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>CSS stylesheet as a formatted string</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#to_s-instance_method" title="Cataract::Stylesheet#to_s (method)">For compact output without formatting</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1093
1094
1095</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cataract/stylesheet.rb', line 1093</span>

<span class='kw'>def</span> <span class='id identifier rubyid_to_formatted_s'>to_formatted_s</span><span class='lparen'>(</span><span class='id identifier rubyid_which_media'>which_media</span> <span class='op'>=</span> <span class='symbol'>:all</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_serialize_with_media_filter'>serialize_with_media_filter</span><span class='lparen'>(</span><span class='id identifier rubyid_which_media'>which_media</span><span class='comma'>,</span> <span class='label'>formatted:</span> <span class='kw'>true</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="to_h-instance_method">
  
    #<strong>to_h</strong>  &#x21d2; <tt>Hash</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Convert stylesheet to nested hash structure.</p>

<p>Returns a hash organized by media type, then selector, then property. This is useful for inspecting the stylesheet structure or converting to JSON for serialization.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Convert to hash</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Cataract::Stylesheet (class)">Stylesheet</a></span></span><span class='period'>.</span><span class='id identifier rubyid_parse'><span class='object_link'><a href="#parse-class_method" title="Cataract::Stylesheet.parse (method)">parse</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>body { color: red; } @media print { body { color: black; } }</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_to_h'>to_h</span>
<span class='comment'>#=&gt; {
</span><span class='comment'>#     &quot;all&quot; =&gt; { &quot;body&quot; =&gt; { &quot;color&quot; =&gt; &quot;red&quot; } },
</span><span class='comment'>#     &quot;print&quot; =&gt; { &quot;body&quot; =&gt; { &quot;color&quot; =&gt; &quot;black&quot; } }
</span><span class='comment'>#   }</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Convert to JSON</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>json</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_to_h'>to_h</span><span class='period'>.</span><span class='id identifier rubyid_to_json'>to_json</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Nested hash: { ‘media_type’ =&gt; { ‘selector’ =&gt; { ‘property’ =&gt; ‘value’ } } } Media types become top-level keys (as strings) Selectors become second-level keys Properties become third-level keys with their values Important declarations include ‘ !important’ suffix</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#to_s-instance_method" title="Cataract::Stylesheet#to_s (method)">For CSS string serialization</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


823
824
825
826
827
828
829
830
831
832
833
834
835
836
837
838
839
840
841
842
843
844
845
846</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cataract/stylesheet.rb', line 823</span>

<span class='kw'>def</span> <span class='id identifier rubyid_to_h'>to_h</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>

  <span class='ivar'>@rule_groups</span><span class='period'>.</span><span class='id identifier rubyid_each_value'>each_value</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_group'>group</span><span class='op'>|</span>
    <span class='id identifier rubyid_group_media_types'>group_media_types</span> <span class='op'>=</span> <span class='id identifier rubyid_group'>group</span><span class='lbracket'>[</span><span class='symbol'>:media_types</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='lbracket'>[</span><span class='symbol'>:all</span><span class='rbracket'>]</span>

    <span class='id identifier rubyid_group_media_types'>group_media_types</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_media_type'>media_type</span><span class='op'>|</span>
      <span class='id identifier rubyid_media_key'>media_key</span> <span class='op'>=</span> <span class='id identifier rubyid_media_type'>media_type</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
      <span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='id identifier rubyid_media_key'>media_key</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>

      <span class='id identifier rubyid_group'>group</span><span class='lbracket'>[</span><span class='symbol'>:rules</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_rule'>rule</span><span class='op'>|</span>
        <span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='id identifier rubyid_media_key'>media_key</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_rule'>rule</span><span class='period'>.</span><span class='id identifier rubyid_selector'>selector</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>

        <span class='comment'># Iterate declarations array directly - no intermediate object
</span>        <span class='id identifier rubyid_rule'>rule</span><span class='period'>.</span><span class='id identifier rubyid_declarations'>declarations</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_decl'>decl</span><span class='op'>|</span>
          <span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='id identifier rubyid_media_key'>media_key</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_rule'>rule</span><span class='period'>.</span><span class='id identifier rubyid_selector'>selector</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_decl'>decl</span><span class='period'>.</span><span class='id identifier rubyid_property'>property</span><span class='rbracket'>]</span> <span class='op'>=</span>
            <span class='id identifier rubyid_decl'>decl</span><span class='period'>.</span><span class='id identifier rubyid_important'>important</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_decl'>decl</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='embexpr_end'>}</span><span class='tstring_content'> !important</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='id identifier rubyid_decl'>decl</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="to_s-instance_method">
  
    #<strong>to_s</strong>(which_media = :all)  &#x21d2; <tt>String</tt> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='to_css-instance_method'>to_css</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Serialize stylesheet to compact CSS string.</p>

<p>Converts the stylesheet back to CSS format. All rules are on single lines with minimal whitespace. Media queries are preserved. Optionally filter by media type to export only specific media rules.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Serialize entire stylesheet</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
<span class='comment'>#=&gt; &quot;body{color:red;}h1{color:blue;}&quot;</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Serialize only print styles</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='lparen'>(</span><span class='symbol'>:print</span><span class='rparen'>)</span>
<span class='comment'>#=&gt; &quot;@media print{body{font-size:12pt;}}&quot;</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Serialize multiple media types</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='symbol'>:screen</span><span class='comma'>,</span> <span class='symbol'>:handheld</span><span class='rbracket'>]</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>which_media</span>
      
      
        <span class='type'>(<tt>Symbol</tt>, <tt>Array&lt;Symbol&gt;</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>:all</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Media type filter (default: :all) When :all, outputs ALL rules regardless of media type When specified, only outputs rules for matching media types Can be an array to match multiple media types</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>CSS stylesheet as a compact string</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#to_formatted_s-instance_method" title="Cataract::Stylesheet#to_formatted_s (method)">For human-readable formatted output</a></span></li>
    
      <li><span class='object_link'><a href="#to_css-instance_method" title="Cataract::Stylesheet#to_css (method)">Alias for this method</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1064
1065
1066</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cataract/stylesheet.rb', line 1064</span>

<span class='kw'>def</span> <span class='id identifier rubyid_to_s'>to_s</span><span class='lparen'>(</span><span class='id identifier rubyid_which_media'>which_media</span> <span class='op'>=</span> <span class='symbol'>:all</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_serialize_with_media_filter'>serialize_with_media_filter</span><span class='lparen'>(</span><span class='id identifier rubyid_which_media'>which_media</span><span class='comma'>,</span> <span class='label'>formatted:</span> <span class='kw'>false</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Thu Nov  6 14:47:38 2025 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.37 (ruby-3.4.5).
</div>

    </div>
  </body>
</html>