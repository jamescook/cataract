<!-- AUTO-GENERATED FILE - DO NOT EDIT -->
<!-- This file is automatically generated from benchmark results. -->
<!-- To regenerate: rake benchmark:generate_docs -->

# Performance Benchmarks

Performance comparison between Cataract's C extension and pure Ruby implementations, with css_parser as a reference.

## Test Environment

- **Ruby**: <%= metadata['ruby_description'] %>
- **CPU**: <%= metadata['cpu'] %>
- **Memory**: <%= metadata['memory'] %>
- **OS**: <%= metadata['os'] %>
- **Generated**: <%= metadata['timestamp'] %>

<%- if parsing_data -%>
## CSS Parsing

<%= parsing_data['description'] %>

| Test Case | Native | Pure (no YJIT) | Pure (YJIT) | css_parser (no YJIT) | css_parser (YJIT) |
|-----------|--------|----------------|-------------|----------------------|-------------------|
<%- parsing_data['metadata']['test_cases'].each do |test_case| -%>
<%- results = parsing_data['results'].select { |r| r['name'].include?(test_case['fixture']) } -%>
<%- pure_no_yjit = results.find { |r| r['implementation'] == 'pure_without_yjit' } -%>
<%- pure_with_yjit = results.find { |r| r['implementation'] == 'pure_with_yjit' } -%>
<%- native = results.find { |r| r['implementation'] == 'native' } -%>
<%- css_no_yjit = results.find { |r| r['implementation'] == 'css_parser_without_yjit' } -%>
<%- css_with_yjit = results.find { |r| r['implementation'] == 'css_parser_with_yjit' } -%>
| <%= test_case['name'] %> | <%= native ? format_ips(native, short: true) : 'N/A' %> | <%= pure_no_yjit ? format_ips(pure_no_yjit, short: true) : 'N/A' %> | <%= pure_with_yjit ? format_ips(pure_with_yjit, short: true) : 'N/A' %> | <%= css_no_yjit ? format_ips(css_no_yjit, short: true) : 'N/A' %> | <%= css_with_yjit ? format_ips(css_with_yjit, short: true) : 'N/A' %> |
<%- end -%>

### Speedups

| Comparison | Speedup |
|------------|---------|
<%- if parsing_data['metadata']['speedups'] -%>
| Native vs Pure (no YJIT) | <%= format_speedup(parsing_data['metadata']['speedups']['avg']) %> (avg) |
<%- end -%>
<%- # Calculate Native vs Pure with YJIT -%>
<%- pure_with_yjit_avg = parsing_data['results'].select { |r| r['implementation'] == 'pure_with_yjit' }.map { |r| r['central_tendency'] }.sum / [parsing_data['results'].select { |r| r['implementation'] == 'pure_with_yjit' }.size, 1].max -%>
<%- native_avg = parsing_data['results'].select { |r| r['implementation'] == 'native' }.map { |r| r['central_tendency'] }.sum / [parsing_data['results'].select { |r| r['implementation'] == 'native' }.size, 1].max -%>
<%- if pure_with_yjit_avg > 0 && native_avg > 0 -%>
| Native vs Pure (YJIT) | <%= format_speedup(native_avg / pure_with_yjit_avg) %> (avg) |
<%- end -%>
<%- # Calculate YJIT impact on pure Ruby -%>
<%- pure_no_yjit_avg = parsing_data['results'].select { |r| r['implementation'] == 'pure_without_yjit' }.map { |r| r['central_tendency'] }.sum / [parsing_data['results'].select { |r| r['implementation'] == 'pure_without_yjit' }.size, 1].max -%>
<%- if pure_no_yjit_avg > 0 && pure_with_yjit_avg > 0 -%>
| YJIT impact on Pure Ruby | <%= format_speedup(pure_with_yjit_avg / pure_no_yjit_avg) %> (avg) |
<%- end -%>

---
<%- end -%>

<%- if serialization_data -%>
## CSS Serialization

<%= serialization_data['description'] %>

| Test Case | Native | Pure (no YJIT) | Pure (YJIT) | css_parser (no YJIT) | css_parser (YJIT) |
|-----------|--------|----------------|-------------|----------------------|-------------------|
<%- serialization_data['metadata']['test_cases'].each do |test_case| -%>
<%- results = serialization_data['results'].select { |r| r['name'].include?(test_case['key']) } -%>
<%- pure_no_yjit = results.find { |r| r['implementation'] == 'pure_without_yjit' } -%>
<%- pure_with_yjit = results.find { |r| r['implementation'] == 'pure_with_yjit' } -%>
<%- native = results.find { |r| r['implementation'] == 'native' } -%>
<%- css_no_yjit = results.find { |r| r['implementation'] == 'css_parser_without_yjit' } -%>
<%- css_with_yjit = results.find { |r| r['implementation'] == 'css_parser_with_yjit' } -%>
| <%= test_case['name'] %> | <%= native ? format_ips(native, short: true) : 'N/A' %> | <%= pure_no_yjit ? format_ips(pure_no_yjit, short: true) : 'N/A' %> | <%= pure_with_yjit ? format_ips(pure_with_yjit, short: true) : 'N/A' %> | <%= css_no_yjit ? format_ips(css_no_yjit, short: true) : 'N/A' %> | <%= css_with_yjit ? format_ips(css_with_yjit, short: true) : 'N/A' %> |
<%- end -%>

### Speedups

| Comparison | Speedup |
|------------|---------|
<%- if serialization_data['metadata']['speedups'] -%>
| Native vs Pure (no YJIT) | <%= format_speedup(serialization_data['metadata']['speedups']['avg']) %> (avg) |
<%- end -%>
<%- # Calculate Native vs Pure with YJIT -%>
<%- pure_with_yjit_avg = serialization_data['results'].select { |r| r['implementation'] == 'pure_with_yjit' }.map { |r| r['central_tendency'] }.sum / [serialization_data['results'].select { |r| r['implementation'] == 'pure_with_yjit' }.size, 1].max -%>
<%- native_avg = serialization_data['results'].select { |r| r['implementation'] == 'native' }.map { |r| r['central_tendency'] }.sum / [serialization_data['results'].select { |r| r['implementation'] == 'native' }.size, 1].max -%>
<%- if pure_with_yjit_avg > 0 && native_avg > 0 -%>
| Native vs Pure (YJIT) | <%= format_speedup(native_avg / pure_with_yjit_avg) %> (avg) |
<%- end -%>
<%- # Calculate YJIT impact on pure Ruby -%>
<%- pure_no_yjit_avg = serialization_data['results'].select { |r| r['implementation'] == 'pure_without_yjit' }.map { |r| r['central_tendency'] }.sum / [serialization_data['results'].select { |r| r['implementation'] == 'pure_without_yjit' }.size, 1].max -%>
<%- if pure_no_yjit_avg > 0 && pure_with_yjit_avg > 0 -%>
| YJIT impact on Pure Ruby | <%= format_speedup(pure_with_yjit_avg / pure_no_yjit_avg) %> (avg) |
<%- end -%>

---
<%- end -%>

<%- if specificity_data -%>
## Specificity Calculation

<%= specificity_data['description'] %>

| Test Case | Native | Pure (no YJIT) | Pure (YJIT) | css_parser (no YJIT) | css_parser (YJIT) |
|-----------|--------|----------------|-------------|----------------------|-------------------|
<%- specificity_data['metadata']['test_cases'].each do |test_case| -%>
<%- results = specificity_data['results'].select { |r| r['name'].include?(test_case['key']) } -%>
<%- pure_no_yjit = results.find { |r| r['implementation'] == 'pure_without_yjit' } -%>
<%- pure_with_yjit = results.find { |r| r['implementation'] == 'pure_with_yjit' } -%>
<%- native = results.find { |r| r['implementation'] == 'native' } -%>
<%- css_no_yjit = results.find { |r| r['implementation'] == 'css_parser_without_yjit' } -%>
<%- css_with_yjit = results.find { |r| r['implementation'] == 'css_parser_with_yjit' } -%>
| <%= test_case['name'] %> | <%= native ? format_ips(native, short: true) : 'N/A' %> | <%= pure_no_yjit ? format_ips(pure_no_yjit, short: true) : 'N/A' %> | <%= pure_with_yjit ? format_ips(pure_with_yjit, short: true) : 'N/A' %> | <%= css_no_yjit ? format_ips(css_no_yjit, short: true) : 'N/A' %> | <%= css_with_yjit ? format_ips(css_with_yjit, short: true) : 'N/A' %> |
<%- end -%>

### Speedups

| Comparison | Speedup |
|------------|---------|
<%- if specificity_data['metadata']['speedups'] -%>
| Native vs Pure (no YJIT) | <%= format_speedup(specificity_data['metadata']['speedups']['avg']) %> (avg) |
<%- end -%>
<%- # Calculate Native vs Pure with YJIT -%>
<%- pure_with_yjit_avg = specificity_data['results'].select { |r| r['implementation'] == 'pure_with_yjit' }.map { |r| r['central_tendency'] }.sum / [specificity_data['results'].select { |r| r['implementation'] == 'pure_with_yjit' }.size, 1].max -%>
<%- native_avg = specificity_data['results'].select { |r| r['implementation'] == 'native' }.map { |r| r['central_tendency'] }.sum / [specificity_data['results'].select { |r| r['implementation'] == 'native' }.size, 1].max -%>
<%- if pure_with_yjit_avg > 0 && native_avg > 0 -%>
| Native vs Pure (YJIT) | <%= format_speedup(native_avg / pure_with_yjit_avg) %> (avg) |
<%- end -%>
<%- # Calculate YJIT impact on pure Ruby -%>
<%- pure_no_yjit_avg = specificity_data['results'].select { |r| r['implementation'] == 'pure_without_yjit' }.map { |r| r['central_tendency'] }.sum / [specificity_data['results'].select { |r| r['implementation'] == 'pure_without_yjit' }.size, 1].max -%>
<%- if pure_no_yjit_avg > 0 && pure_with_yjit_avg > 0 -%>
| YJIT impact on Pure Ruby | <%= format_speedup(pure_with_yjit_avg / pure_no_yjit_avg) %> (avg) |
<%- end -%>

---
<%- end -%>

<%- if flattening_data -%>
## CSS Flattening (Cascade)

<%= flattening_data['description'] %>

| Test Case | Native | Pure (no YJIT) | Pure (YJIT) | css_parser (no YJIT) | css_parser (YJIT) |
|-----------|--------|----------------|-------------|----------------------|-------------------|
<%- flattening_data['metadata']['test_cases'].each do |test_case| -%>
<%- results = flattening_data['results'].select { |r| r['name'].include?(test_case['key']) } -%>
<%- pure_no_yjit = results.find { |r| r['implementation'] == 'pure_without_yjit' } -%>
<%- pure_with_yjit = results.find { |r| r['implementation'] == 'pure_with_yjit' } -%>
<%- native = results.find { |r| r['implementation'] == 'native' } -%>
<%- css_no_yjit = results.find { |r| r['implementation'] == 'css_parser_without_yjit' } -%>
<%- css_with_yjit = results.find { |r| r['implementation'] == 'css_parser_with_yjit' } -%>
| <%= test_case['name'] %> | <%= native ? format_ips(native, short: true) : 'N/A' %> | <%= pure_no_yjit ? format_ips(pure_no_yjit, short: true) : 'N/A' %> | <%= pure_with_yjit ? format_ips(pure_with_yjit, short: true) : 'N/A' %> | <%= css_no_yjit ? format_ips(css_no_yjit, short: true) : 'N/A' %> | <%= css_with_yjit ? format_ips(css_with_yjit, short: true) : 'N/A' %> |
<%- end -%>

### Speedups

| Comparison | Speedup |
|------------|---------|
<%- if flattening_data['metadata']['speedups'] -%>
| Native vs Pure (no YJIT) | <%= format_speedup(flattening_data['metadata']['speedups']['avg']) %> (avg) |
<%- end -%>
<%- # Calculate Native vs Pure with YJIT -%>
<%- pure_with_yjit_avg = flattening_data['results'].select { |r| r['implementation'] == 'pure_with_yjit' }.map { |r| r['central_tendency'] }.sum / [flattening_data['results'].select { |r| r['implementation'] == 'pure_with_yjit' }.size, 1].max -%>
<%- native_avg = flattening_data['results'].select { |r| r['implementation'] == 'native' }.map { |r| r['central_tendency'] }.sum / [flattening_data['results'].select { |r| r['implementation'] == 'native' }.size, 1].max -%>
<%- if pure_with_yjit_avg > 0 && native_avg > 0 -%>
| Native vs Pure (YJIT) | <%= format_speedup(native_avg / pure_with_yjit_avg) %> (avg) |
<%- end -%>
<%- # Calculate YJIT impact on pure Ruby -%>
<%- pure_no_yjit_avg = flattening_data['results'].select { |r| r['implementation'] == 'pure_without_yjit' }.map { |r| r['central_tendency'] }.sum / [flattening_data['results'].select { |r| r['implementation'] == 'pure_without_yjit' }.size, 1].max -%>
<%- if pure_no_yjit_avg > 0 && pure_with_yjit_avg > 0 -%>
| YJIT impact on Pure Ruby | <%= format_speedup(pure_with_yjit_avg / pure_no_yjit_avg) %> (avg) |
<%- end -%>

---
<%- end -%>

## Running Benchmarks

```bash
# All benchmarks
rake benchmark

# Individual benchmarks
rake benchmark:parsing
rake benchmark:serialization
rake benchmark:specificity
rake benchmark:flattening

# Generate documentation
rake benchmark:generate_docs
```

## Notes

- Benchmarks use benchmark-ips with 1-2s warmup and 2-5s measurement periods
- Measurements show median iterations per second (i/s)
- css_parser gem is included for reference comparison
- YJIT is enabled/disabled per subprocess for accurate comparison
