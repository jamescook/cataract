<!-- AUTO-GENERATED FILE - DO NOT EDIT -->
<!-- This file is automatically generated from benchmark results. -->
<!-- To regenerate: rake benchmark:generate_docs -->

# Performance Benchmarks

Performance comparison between Cataract's C extension and pure Ruby implementations.

## Test Environment

- **Ruby**: <%= metadata['ruby_description'] %>
- **CPU**: <%= metadata['cpu'] %>
- **Memory**: <%= metadata['memory'] %>
- **OS**: <%= metadata['os'] %>
- **Generated**: <%= metadata['timestamp'] %>

<%- if parsing_data -%>
## CSS Parsing

<%= parsing_data['description'] %>

| Test Case | Native | Pure (no YJIT) | Pure (YJIT) |
|-----------|--------|----------------|-------------|
<%- parsing_data['metadata']['test_cases'].each do |test_case| -%>
<%- results = parsing_data['results'].select { |r| r['name'].include?(test_case['fixture']) } -%>
<%- pure_no_yjit = results.find { |r| r['implementation'] == 'pure_without_yjit' } -%>
<%- pure_with_yjit = results.find { |r| r['implementation'] == 'pure_with_yjit' } -%>
<%- native = results.find { |r| r['implementation'] == 'native' } -%>
| <%= test_case['name'] %> | <%= native ? format_ips(native, short: true) : 'N/A' %> | <%= pure_no_yjit ? format_ips(pure_no_yjit, short: true) : 'N/A' %> | <%= pure_with_yjit ? format_ips(pure_with_yjit, short: true) : 'N/A' %> |
<%- end -%>

### Speedups

| Comparison | Speedup |
|------------|---------|
<%= speedup_rows(parsing_data, test_case_key: :fixture) %>

### Parse Error Checking Overhead

Parse error detection can be enabled with `raise_parse_errors: true`. This compares performance impact:

| Configuration | Native | Pure (no YJIT) | Pure (YJIT) |
|---------------|--------|----------------|-------------|
<%- if parsing_data['metadata']['error_checking'] -%>
<%- parsing_data['metadata']['error_checking'].each do |test_case| -%>
<%-
  # Match results by checking if the name contains the key words
  search_term = test_case['key'].gsub('_', ' ')
  results = parsing_data['results'].select { |r| r['name'].include?(search_term) }
  pure_no_yjit = results.find { |r| r['implementation'] == 'pure_without_yjit' }
  pure_with_yjit = results.find { |r| r['implementation'] == 'pure_with_yjit' }
  native = results.find { |r| r['implementation'] == 'native' }
-%>
| <%= test_case['name'] %> | <%= native ? format_ips(native, short: true) : 'N/A' %> | <%= pure_no_yjit ? format_ips(pure_no_yjit, short: true) : 'N/A' %> | <%= pure_with_yjit ? format_ips(pure_with_yjit, short: true) : 'N/A' %> |
<%- end -%>

**Overhead Analysis:**

<%-
  # Calculate overhead for each implementation
  off_results = parsing_data['results'].select { |r| r['name'].include?('error checking off') }
  on_results = parsing_data['results'].select { |r| r['name'].include?('error checking on') }

  native_off = off_results.find { |r| r['implementation'] == 'native' }
  native_on = on_results.find { |r| r['implementation'] == 'native' }

  pure_no_yjit_off = off_results.find { |r| r['implementation'] == 'pure_without_yjit' }
  pure_no_yjit_on = on_results.find { |r| r['implementation'] == 'pure_without_yjit' }

  pure_with_yjit_off = off_results.find { |r| r['implementation'] == 'pure_with_yjit' }
  pure_with_yjit_on = on_results.find { |r| r['implementation'] == 'pure_with_yjit' }
-%>

| Implementation | Overhead |
|----------------|----------|
<%- if native_off && native_on -%>
<%-
  slowdown = ((native_off['ips'] / native_on['ips']) - 1) * 100
  overhead_text = if slowdown.abs < 1.0
    "~0% (within noise)"
  elsif slowdown < 0
    "%.1f%% faster (unexpected)" % slowdown.abs
  else
    "%.1f%% slower" % slowdown
  end
-%>
| Native | <%= overhead_text %> |
<%- end -%>
<%- if pure_no_yjit_off && pure_no_yjit_on -%>
<%-
  slowdown = ((pure_no_yjit_off['ips'] / pure_no_yjit_on['ips']) - 1) * 100
  overhead_text = if slowdown.abs < 1.0
    "~0% (within noise)"
  elsif slowdown < 0
    "%.1f%% faster (unexpected)" % slowdown.abs
  else
    "%.1f%% slower" % slowdown
  end
-%>
| Pure (no YJIT) | <%= overhead_text %> |
<%- end -%>
<%- if pure_with_yjit_off && pure_with_yjit_on -%>
<%-
  slowdown = ((pure_with_yjit_off['ips'] / pure_with_yjit_on['ips']) - 1) * 100
  overhead_text = if slowdown.abs < 1.0
    "~0% (within noise)"
  elsif slowdown < 0
    "%.1f%% faster (unexpected)" % slowdown.abs
  else
    "%.1f%% slower" % slowdown
  end
-%>
| Pure (YJIT) | <%= overhead_text %> |
<%- end -%>
<%- end -%>

---
<%- end -%>

<%- if serialization_data -%>
## CSS Serialization

<%= serialization_data['description'] %>

| Test Case | Native | Pure (no YJIT) | Pure (YJIT) |
|-----------|--------|----------------|-------------|
<%- serialization_data['metadata']['test_cases'].each do |test_case| -%>
<%- results = serialization_data['results'].select { |r| r['name'].include?(test_case['key']) } -%>
<%- pure_no_yjit = results.find { |r| r['implementation'] == 'pure_without_yjit' } -%>
<%- pure_with_yjit = results.find { |r| r['implementation'] == 'pure_with_yjit' } -%>
<%- native = results.find { |r| r['implementation'] == 'native' } -%>
| <%= test_case['name'] %> | <%= native ? format_ips(native, short: true) : 'N/A' %> | <%= pure_no_yjit ? format_ips(pure_no_yjit, short: true) : 'N/A' %> | <%= pure_with_yjit ? format_ips(pure_with_yjit, short: true) : 'N/A' %> |
<%- end -%>

### Speedups

| Comparison | Speedup |
|------------|---------|
<%= speedup_rows(serialization_data, test_case_key: :key) %>

---
<%- end -%>

<%- if specificity_data -%>
## Specificity Calculation

<%= specificity_data['description'] %>

| Test Case | Native | Pure (no YJIT) | Pure (YJIT) |
|-----------|--------|----------------|-------------|
<%- specificity_data['metadata']['test_cases'].each do |test_case| -%>
<%- results = specificity_data['results'].select { |r| r['name'].include?(test_case['key']) } -%>
<%- pure_no_yjit = results.find { |r| r['implementation'] == 'pure_without_yjit' } -%>
<%- pure_with_yjit = results.find { |r| r['implementation'] == 'pure_with_yjit' } -%>
<%- native = results.find { |r| r['implementation'] == 'native' } -%>
| <%= test_case['name'] %> | <%= native ? format_ips(native, short: true) : 'N/A' %> | <%= pure_no_yjit ? format_ips(pure_no_yjit, short: true) : 'N/A' %> | <%= pure_with_yjit ? format_ips(pure_with_yjit, short: true) : 'N/A' %> |
<%- end -%>

### Speedups

| Comparison | Speedup |
|------------|---------|
<%= speedup_rows(specificity_data, test_case_key: :key) %>

---
<%- end -%>

<%- if flattening_data -%>
## CSS Flattening (Cascade)

<%= flattening_data['description'] %>

| Test Case | Native | Pure (no YJIT) | Pure (YJIT) |
|-----------|--------|----------------|-------------|
<%- flattening_data['metadata']['test_cases'].each do |test_case| -%>
<%- results = flattening_data['results'].select { |r| r['name'].include?(test_case['key']) } -%>
<%- pure_no_yjit = results.find { |r| r['implementation'] == 'pure_without_yjit' } -%>
<%- pure_with_yjit = results.find { |r| r['implementation'] == 'pure_with_yjit' } -%>
<%- native = results.find { |r| r['implementation'] == 'native' } -%>
| <%= test_case['name'] %> | <%= native ? format_ips(native, short: true) : 'N/A' %> | <%= pure_no_yjit ? format_ips(pure_no_yjit, short: true) : 'N/A' %> | <%= pure_with_yjit ? format_ips(pure_with_yjit, short: true) : 'N/A' %> |
<%- end -%>

### Speedups

| Comparison | Speedup |
|------------|---------|
<%= speedup_rows(flattening_data, test_case_key: :key) %>

---
<%- end -%>

## Running Benchmarks

```bash
# All benchmarks
rake benchmark

# Individual benchmarks
rake benchmark:parsing
rake benchmark:serialization
rake benchmark:specificity
rake benchmark:flattening

# Generate documentation
rake benchmark:generate_docs
```

## Notes

- Benchmarks use benchmark-ips with 1-2s warmup and 2-5s measurement periods
- Measurements show median iterations per second (i/s)
- YJIT is enabled/disabled per subprocess for accurate comparison
